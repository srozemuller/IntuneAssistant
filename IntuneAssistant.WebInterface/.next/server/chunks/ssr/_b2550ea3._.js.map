{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/srozemuller/Repos/IntuneAssistant/IntuneAssistant.WebInterface/components/DataTable.tsx"],"sourcesContent":["// components/DataTable.tsx\n'use client';\nimport { useState, useRef, useEffect, useMemo } from 'react';\nimport {ITEMS_PER_PAGE} from \"@/lib/constants\";\nimport { ChevronLeft, ChevronRight, ChevronUp, ChevronDown, ChevronsUpDown, Search, X } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\n\ninterface Column {\n    key: string;\n    label: string;\n    width?: number;\n    minWidth?: number;\n    sortable?: boolean;\n    searchable?: boolean;\n    sortValue?: (row: Record<string, unknown>) => number | string;\n    render?: (value: unknown, row: Record<string, unknown>) => React.ReactNode;\n}\n\ninterface SortConfig {\n    key: string;\n    direction: 'asc' | 'desc';\n}\n\ninterface DataTableProps {\n    data: Record<string, unknown>[];\n    columns: Column[];\n    className?: string;\n    onRowClick?: (row: Record<string, unknown>, index: number, event?: React.MouseEvent) => void;\n    rowClassName?: (row: Record<string, unknown>) => string;\n    currentPage?: number;\n    totalPages?: number;\n    itemsPerPage?: number;\n    onPageChange?: (page: number) => void;\n    onItemsPerPageChange?: (itemsPerPage: number) => void;\n    showPagination?: boolean;\n    showSearch?: boolean;\n    searchPlaceholder?: string;\n    selectedRows?: string[];\n    onSelectionChange?: (rowIds: string[]) => void;\n}\n\nexport function DataTable({\n                              data,\n                              columns: initialColumns,\n                              className = '',\n                              onRowClick,\n                              currentPage = 1,\n                              totalPages = 1,\n                              itemsPerPage = ITEMS_PER_PAGE,\n                              onPageChange,\n                              rowClassName,\n                              onItemsPerPageChange,\n                              showPagination = false,\n                              showSearch = true,\n                              searchPlaceholder = \"Search...\",\n                              onSelectionChange,\n                              selectedRows = [],\n                          }: DataTableProps) {\n\n    // Local pagination state to support uncontrolled usage\n    const [internalCurrentPage, setInternalCurrentPage] = useState<number>(currentPage);\n    const [internalItemsPerPage, setInternalItemsPerPage] = useState<number>(itemsPerPage);\n\n    // Sync internal state when parent updates props\n    useEffect(() => setInternalCurrentPage(currentPage), [currentPage]);\n    useEffect(() => setInternalItemsPerPage(itemsPerPage), [itemsPerPage]);\n\n    // Effective values: prefer controller (props) when callbacks are provided\n    const effectiveCurrentPage = onPageChange ? currentPage : internalCurrentPage;\n    const effectiveItemsPerPage = onItemsPerPageChange ? itemsPerPage : internalItemsPerPage;\n\n    const changePage = (page: number) => {\n        if (onPageChange) {\n            onPageChange(page);\n        } else {\n            setInternalCurrentPage(page);\n        }\n    };\n\n    const changeItemsPerPage = (n: number) => {\n        if (onItemsPerPageChange) {\n            onItemsPerPageChange(n);\n        } else {\n            setInternalItemsPerPage(n);\n        }\n    };\n\n    const isRowSelected = (row: Record<string, unknown>) => {\n        if (!selectedRows || selectedRows.length === 0) return false;\n        const rowId = String(row.id);\n        return selectedRows.includes(rowId);\n    };\n\n    const handleRowSelection = (e: React.MouseEvent | React.ChangeEvent<HTMLInputElement>, row: Record<string, unknown>) => {\n        e.stopPropagation();\n        const rowId = String(row.id);\n\n        if (onSelectionChange) {\n            const isCurrentlySelected = isRowSelected(row);\n            if (isCurrentlySelected) {\n                onSelectionChange(selectedRows.filter(id => id !== rowId));\n            } else {\n                onSelectionChange([...selectedRows, rowId]);\n            }\n        }\n    };\n\n    const columnsWithSelection = useMemo(() => {\n        if (onSelectionChange && !initialColumns.some(col => col.key === '_select')) {\n            return [\n                {\n                    key: '_select',\n                    label: '',\n                    width: 50,\n                    minWidth: 40,\n                    sortable: false,\n                    searchable: false,\n                    sortValue: undefined,\n                    render: (_, row) => (\n                        <input\n                            type=\"checkbox\"\n                            checked={isRowSelected(row)}\n                            onChange={(e) => handleRowSelection(e, row)}\n                            className=\"rounded border-input text-primary focus:ring-ring\"\n                        />\n                    )\n\n                },\n                ...initialColumns\n            ];\n        }\n        return initialColumns;\n    }, [onSelectionChange, selectedRows, initialColumns]);\n\n    const [columns, setColumns] = useState(columnsWithSelection.map(col => ({\n        ...col,\n        width: col.width || 150,\n        minWidth: col.minWidth || 100,\n        searchable: col.searchable !== false && col.key !== '_select',\n        sortValue: col.sortValue\n    })));\n\n    const [sortConfig, setSortConfig] = useState<SortConfig | null>(null);\n    const [searchTerm, setSearchTerm] = useState('');\n    const [resizing, setResizing] = useState<{ columnIndex: number; startX: number; startWidth: number } | null>(null);\n    const tableRef = useRef<HTMLTableElement>(null);\n\n    useEffect(() => {\n        setColumns(columnsWithSelection.map(col => ({\n            ...col,\n            width: col.width || 150,\n            minWidth: col.minWidth || 100,\n            searchable: col.searchable !== false && col.key !== '_select',\n            sortValue: col.sortValue\n        })));\n    }, [columnsWithSelection]);\n\n    // Filter data based on search term\n    const filteredData = data.filter(row => {\n        if (!searchTerm.trim()) return true;\n\n        const searchLower = searchTerm.toLowerCase();\n\n        // Search through ALL properties in the row, not just the column keys\n        return Object.entries(row).some(([key, value]) => {\n            if (value === null || value === undefined) return false;\n            const stringValue = String(value).toLowerCase();\n            return stringValue.includes(searchLower);\n        });\n    });\n\n    // Sort filtered data\n    const sortedData = [...filteredData].sort((a, b) => {\n        if (!sortConfig) return 0;\n\n        // Find the column configuration to check for custom sortValue\n        const column = columns.find(col => col.key === sortConfig.key);\n\n        // Use sortValue function if provided, otherwise fall back to direct value\n        const aValue = column?.sortValue ? column.sortValue(a) : a[sortConfig.key];\n        const bValue = column?.sortValue ? column.sortValue(b) : b[sortConfig.key];\n\n        if (aValue === undefined && bValue === undefined) {\n            return 0;\n        }\n\n        if (aValue === null || aValue === undefined) return 1;\n        if (bValue === null || bValue === undefined) return -1;\n\n        if (typeof aValue === 'number' && typeof bValue === 'number') {\n            return sortConfig.direction === 'asc'\n                ? aValue - bValue\n                : bValue - aValue;\n        }\n\n        const aDate = new Date(aValue as string);\n        const bDate = new Date(bValue as string);\n        if (!isNaN(aDate.getTime()) && !isNaN(bDate.getTime())) {\n            return sortConfig.direction === 'asc'\n                ? aDate.getTime() - bDate.getTime()\n                : bDate.getTime() - aDate.getTime();\n        }\n\n        const aStr = String(aValue).toLowerCase();\n        const bStr = String(bValue).toLowerCase();\n\n        if (aStr < bStr) return sortConfig.direction === 'asc' ? -1 : 1;\n        if (aStr > bStr) return sortConfig.direction === 'asc' ? 1 : -1;\n        return 0;\n    });\n\n\n    // Update pagination to work with filtered/sorted data\n    const startIndex = (effectiveCurrentPage - 1) * effectiveItemsPerPage;\n    const endIndex = startIndex + effectiveItemsPerPage;\n    const paginatedData = sortedData.slice(startIndex, endIndex);\n    const totalFilteredPages = Math.max(1, Math.ceil(sortedData.length / effectiveItemsPerPage));\n\n    const handleSort = (columnKey: string) => {\n        let direction: 'asc' | 'desc' = 'asc';\n\n        if (sortConfig && sortConfig.key === columnKey && sortConfig.direction === 'asc') {\n            direction = 'desc';\n        }\n\n        setSortConfig({ key: columnKey, direction });\n    };\n\n    const getSortIcon = (columnKey: string) => {\n        if (!sortConfig || sortConfig.key !== columnKey) {\n            return <ChevronsUpDown className=\"h-4 w-4 text-muted-foreground\" />;\n        }\n\n        return sortConfig.direction === 'asc'\n            ? <ChevronUp className=\"h-4 w-4 text-foreground\" />\n            : <ChevronDown className=\"h-4 w-4 text-foreground\" />;\n    };\n\n\n    const clearSearch = () => {\n        setSearchTerm('');\n        changePage(1);\n    };\n\n    useEffect(() => {\n        if (effectiveCurrentPage > 1) {\n            changePage(1);\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [searchTerm]);\n\n    useEffect(() => {\n        const maxPage = Math.max(1, Math.ceil(sortedData.length / effectiveItemsPerPage));\n        if (effectiveCurrentPage > maxPage) {\n            changePage(1);\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [effectiveItemsPerPage, sortedData.length, effectiveCurrentPage]);\n\n    useEffect(() => {\n        const handleMouseMove = (e: MouseEvent) => {\n            if (!resizing) return;\n\n            const diff = e.clientX - resizing.startX;\n            const newWidth = Math.max(resizing.startWidth + diff, columns[resizing.columnIndex].minWidth || 100);\n\n            setColumns(prev => prev.map((col, index) =>\n                index === resizing.columnIndex ? { ...col, width: newWidth } : col\n            ));\n        };\n\n        const handleMouseUp = () => {\n            setResizing(null);\n        };\n\n        if (resizing) {\n            document.addEventListener('mousemove', handleMouseMove);\n            document.addEventListener('mouseup', handleMouseUp);\n        }\n\n        return () => {\n            document.removeEventListener('mousemove', handleMouseMove);\n            document.removeEventListener('mouseup', handleMouseUp);\n        };\n    }, [resizing, columns]);\n\n    const handleResizeStart = (e: React.MouseEvent, columnIndex: number) => {\n        e.preventDefault();\n        e.stopPropagation();\n        setResizing({\n            columnIndex,\n            startX: e.clientX,\n            startWidth: columns[columnIndex].width || 150\n        });\n    };\n\n    const handleRowClick = (e: React.MouseEvent, row: Record<string, unknown>, index: number) => {\n        if (resizing) return;\n\n        const target = e.target as HTMLElement;\n        const isInteractive = target.closest('input[type=\"checkbox\"], input[type=\"radio\"], button, a, [role=\"button\"], [tabindex=\"0\"]');\n\n        if (!isInteractive && onRowClick) {\n            onRowClick(row, index, e);\n        }\n    };\n\n\n    const getCellValue = (row: Record<string, unknown>, column: Column) => {\n        if (column.key === '_select') {\n            return null;\n        }\n        return row[column.key];\n    };\n\n    return (\n        <div className={`bg-background border rounded-lg overflow-hidden shadow-sm ${className}`}>\n            {showSearch && (\n                <div className=\"p-4 bg-muted border-b\">\n                    <div className=\"relative max-w-sm\">\n                        <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                        <input\n                            type=\"text\"\n                            placeholder={searchPlaceholder}\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                            className=\"w-full pl-10 pr-10 py-2 border rounded-md bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent transition-colors\"\n                        />\n                        {searchTerm && (\n                            <button\n                                onClick={clearSearch}\n                                className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors\"\n                            >\n                                <X className=\"h-4 w-4\" />\n                            </button>\n                        )}\n                    </div>\n                    {searchTerm && (\n                        <div className=\"mt-2 text-sm text-muted-foreground\">\n                            {sortedData.length} of {data.length} results\n                        </div>\n                    )}\n                </div>\n            )}\n\n            <div className=\"overflow-auto\">\n                <table ref={tableRef} className=\"w-full text-sm\">\n                    <thead className=\"bg-background sticky top-0 z-10 border-b\">\n\n                    <tr className=\"border-b\">\n                        {columns.map((column, index) => (\n                            <th\n                                key={column.key}\n                                className=\"relative text-left p-3 font-medium text-foreground\"\n                                style={{ width: `${column.width}px` }}\n                            >\n                                <div className=\"flex items-center justify-between\">\n                                    <div\n                                        className={`flex items-center gap-2 flex-1 ${\n                                            column.sortable !== false && column.key !== '_select'\n                                                ? 'cursor-pointer hover:text-primary transition-colors'\n                                                : ''\n                                        }`}\n                                        onClick={() => {\n                                            if (column.sortable !== false && column.key !== '_select') {\n                                                handleSort(column.key);\n                                            }\n                                        }}\n                                    >\n                                        <span className=\"truncate pr-2\">{column.label}</span>\n                                        {column.sortable !== false && column.key !== '_select' && (\n                                            getSortIcon(column.key)\n                                        )}\n                                    </div>\n                                </div>\n\n                                {column.key !== '_select' && (\n                                    <div\n                                        className=\"absolute right-0 top-0 h-full w-1 cursor-col-resize hover:bg-primary group\"\n                                        onMouseDown={(e) => handleResizeStart(e, index)}\n                                    >\n                                        <div className=\"h-full w-px bg-border group-hover:bg-primary transition-colors\" />\n                                    </div>\n                                )}\n                            </th>\n                        ))}\n                    </tr>\n                    </thead>\n                    <tbody className=\"bg-background divide-y divide-border\">\n                    {paginatedData.length > 0 ? (\n                        paginatedData.map((row, rowIndex) => (\n                            <tr\n                                key={rowIndex}\n                                className={`\n                transition-colors\n                ${onRowClick ? 'cursor-pointer' : ''}\n                ${isRowSelected(row)\n                                    ? 'bg-yellow-400 dark:bg-yellow-400/80 text-foreground border-l-4 border-l-yellow-600 dark:border-l-yellow-400 shadow-md ring-1 ring-yellow-500/30'\n                                    : 'hover:bg-muted/50'\n                                }\n                ${rowClassName ? rowClassName(row) : ''}\n            `}\n                                onClick={(e) => handleRowClick(e, row, startIndex + rowIndex)}\n                            >\n\n                            {columns.map((column) => (\n                                    <td\n                                        key={column.key}\n                                        className=\"p-3 text-foreground\"\n                                        style={{ width: `${column.width}px` }}\n                                    >\n                                        <div className=\"overflow-hidden\">\n                                            {column.render\n                                                ? column.render(getCellValue(row, column), row)\n                                                : String(getCellValue(row, column) || '')\n                                            }\n                                        </div>\n                                    </td>\n                                ))}\n                            </tr>\n                        ))\n                    ) : (\n                        <tr>\n                            <td\n                                colSpan={columns.length}\n                                className=\"p-8 text-center text-muted-foreground bg-muted/50\"\n                            >\n                                {searchTerm ? 'No results found for your search.' : 'No data available.'}\n                            </td>\n                        </tr>\n                    )}\n                    </tbody>\n                </table>\n            </div>\n\n            {showPagination && sortedData.length > 0 && (\n                <div className=\"flex items-center justify-between p-4 border-t bg-muted\">\n                    <div className=\"flex items-center gap-4\">\n                        <div className=\"text-sm text-muted-foreground\">\n                            Showing {Math.min(startIndex + 1, sortedData.length)} to {Math.min(endIndex, sortedData.length)} of {sortedData.length} results\n                            {searchTerm && ` (filtered from ${data.length} total)`}\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                            <span className=\"text-sm text-muted-foreground\">Items per page:</span>\n                            <select\n                                value={effectiveItemsPerPage}\n                                onChange={(e) => {\n                                    const newItemsPerPage = Number(e.target.value);\n                                    changeItemsPerPage(newItemsPerPage);\n                                    changePage(1);\n                                }}\n                                className=\"border rounded px-2 py-1 text-sm bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-ring transition-colors\"\n                            >\n                                <option value={10}>10</option>\n                                <option value={25}>25</option>\n                                <option value={50}>50</option>\n                                <option value={100}>100</option>\n                            </select>\n                        </div>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                        <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => changePage(Math.max(1, effectiveCurrentPage - 1))}\n                            disabled={effectiveCurrentPage === 1}\n                        >\n                            <ChevronLeft className=\"h-4 w-4\" />\n                            Previous\n                        </Button>\n\n                        <div className=\"flex items-center gap-1\">\n                            {Array.from({ length: Math.min(5, totalFilteredPages) }, (_, i) => {\n                                let pageNum;\n                                if (totalFilteredPages <= 5) {\n                                    pageNum = i + 1;\n                                } else if (effectiveCurrentPage <= 3) {\n                                    pageNum = i + 1;\n                                } else if (effectiveCurrentPage >= totalFilteredPages - 2) {\n                                    pageNum = totalFilteredPages - 4 + i;\n                                } else {\n                                    pageNum = effectiveCurrentPage - 2 + i;\n                                }\n\n                                return (\n                                    <Button\n                                        key={pageNum}\n                                        variant={effectiveCurrentPage === pageNum ? \"default\" : \"outline\"}\n                                        size=\"sm\"\n                                        onClick={() => changePage(pageNum)}\n                                        className=\"w-8 h-8 p-0\"\n                                    >\n                                        {pageNum}\n                                    </Button>\n                                );\n                            })}\n                        </div>\n\n                        <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => changePage(Math.min(totalFilteredPages, effectiveCurrentPage + 1))}\n                            disabled={effectiveCurrentPage === totalFilteredPages}\n                        >\n                            Next\n                            <ChevronRight className=\"h-4 w-4\" />\n                        </Button>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 675, "column": 0}, "map": {"version":3,"sources":["file:///Users/srozemuller/Repos/IntuneAssistant/IntuneAssistant.WebInterface/components/ui/switch.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SwitchPrimitive from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Switch({\n  className,\n  ...props\n}: React.ComponentProps<typeof SwitchPrimitive.Root>) {\n  return (\n    <SwitchPrimitive.Root\n      data-slot=\"switch\"\n      className={cn(\n        \"peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <SwitchPrimitive.Thumb\n        data-slot=\"switch-thumb\"\n        className={cn(\n          \"bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0\"\n        )}\n      />\n    </SwitchPrimitive.Root>\n  )\n}\n\nexport { Switch }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,OAAO,EACd,SAAS,EACT,GAAG,OAC+C;IAClD,qBACE,8OAAC,0KAAoB;QACnB,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,6WACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,2KAAqB;YACpB,aAAU;YACV,WAAW,IAAA,kHAAE,EACX;;;;;;;;;;;AAKV","debugId":null}},
    {"offset": {"line": 710, "column": 0}, "map": {"version":3,"sources":["file:///Users/srozemuller/Repos/IntuneAssistant/IntuneAssistant.WebInterface/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Input({ className, type, ...props }: React.ComponentProps<\"input\">) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        \"file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        \"focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]\",\n        \"aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,8OAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,mcACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 735, "column": 0}, "map": {"version":3,"sources":["file:///Users/srozemuller/Repos/IntuneAssistant/IntuneAssistant.WebInterface/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,8OAAC,yKAAmB;QAClB,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 762, "column": 0}, "map": {"version":3,"sources":["file:///Users/srozemuller/Repos/IntuneAssistant/IntuneAssistant.WebInterface/lib/errors.ts"],"sourcesContent":["export class UserConsentRequiredError extends Error {\n    consentUrl: string;\n\n    constructor(url: string, message: string = 'Additional permissions required') {\n        super(message);\n        this.name = 'UserConsentRequiredError';\n        this.consentUrl = url;\n    }\n}"],"names":[],"mappings":";;;;AAAO,MAAM,iCAAiC;IAC1C,WAAmB;IAEnB,YAAY,GAAW,EAAE,UAAkB,iCAAiC,CAAE;QAC1E,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,UAAU,GAAG;IACtB;AACJ","debugId":null}},
    {"offset": {"line": 778, "column": 0}, "map": {"version":3,"sources":["file:///Users/srozemuller/Repos/IntuneAssistant/IntuneAssistant.WebInterface/lib/apiRequest.ts"],"sourcesContent":["// lib/apiRequest.ts\nimport { UserConsentRequiredError } from '@/lib/errors';\n\nexport class ApiError extends Error {\n    public correlationId?: string | null;\n    public status?: number;\n\n    constructor(message: string, correlationId?: string | null, status?: number) {\n        super(message);\n        this.name = 'ApiError';\n        this.correlationId = correlationId;\n        this.status = status;\n    }\n}\n\nexport async function apiRequest<T>(url: string, options: RequestInit = {}, token?: string): Promise<T> {\n    try {\n        // Add authorization header if token is provided\n        const headers = {\n            'Content-Type': 'application/json',\n            ...options.headers,\n            ...(token && { Authorization: `Bearer ${token}` })\n        };\n\n        const response = await fetch(url, {\n            ...options,\n            headers\n        });\n\n        // Extract correlation ID from response headers ALWAYS\n        const correlationId = response.headers.get('x-correlation-id') ||\n            response.headers.get('X-Correlation-ID') ||\n            response.headers.get('correlation-id') ||\n            response.headers.get('Correlation-ID');\n\n        // Handle non-JSON responses\n        const contentType = response.headers.get('content-type');\n        const isJson = contentType && contentType.includes('application/json');\n\n        // Parse response\n        const data = isJson ? await response.json() : await response.text();\n\n        // Handle 401 specifically for consent\n        if (response.status === 401) {\n            console.log(\"401 response detected:\", JSON.stringify(data, null, 2));\n\n            if (data?.message?.url) {\n                console.log(\"Consent URL found:\", data.message.url);\n                throw new UserConsentRequiredError(\n                    data.message.url,\n                    data.message.message || \"Additional permissions required\"\n                );\n            }\n\n            const consentUrl = data?.consentUrl || data?.message?.url;\n            if (consentUrl) {\n                console.log(\"Consent URL detected:\", consentUrl);\n                throw new UserConsentRequiredError(consentUrl);\n            }\n        }\n\n        // Handle ALL other error status codes (400, 500, etc.)\n        if (!response.ok) {\n            console.log(`Error ${response.status} response data:`, JSON.stringify(data, null, 2));\n\n            // Debug: Log ALL headers to see what we actually have\n            console.log(\"=== ALL RESPONSE HEADERS ===\");\n            for (const [key, value] of response.headers) {\n                console.log(`${key}: ${value}`);\n            }\n\n\n\n            // Create error message based on status code, not response content\n            const errorMessage = `API request failed: ${response.status} - ${response.statusText || 'HTTP Error'}`;\n\n            console.log(\"Final error message:\", errorMessage);\n            throw new ApiError(errorMessage, correlationId, response.status);\n        }\n\n        // Success case\n        console.log(\"Success response, correlation ID:\", correlationId);\n        return data as T;\n    } catch (error) {\n        // Re-throw specific errors\n        if (error instanceof UserConsentRequiredError || error instanceof ApiError) {\n            throw error;\n        }\n\n        console.error(\"API request error:\", error);\n        throw error;\n    }\n}\n"],"names":[],"mappings":"AAAA,oBAAoB;;;;;;;AACpB;;AAEO,MAAM,iBAAiB;IACnB,cAA8B;IAC9B,OAAgB;IAEvB,YAAY,OAAe,EAAE,aAA6B,EAAE,MAAe,CAAE;QACzE,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,aAAa,GAAG;QACrB,IAAI,CAAC,MAAM,GAAG;IAClB;AACJ;AAEO,eAAe,WAAc,GAAW,EAAE,UAAuB,CAAC,CAAC,EAAE,KAAc;IACtF,IAAI;QACA,gDAAgD;QAChD,MAAM,UAAU;YACZ,gBAAgB;YAChB,GAAG,QAAQ,OAAO;YAClB,GAAI,SAAS;gBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;YAAC,CAAC;QACrD;QAEA,MAAM,WAAW,MAAM,MAAM,KAAK;YAC9B,GAAG,OAAO;YACV;QACJ;QAEA,sDAAsD;QACtD,MAAM,gBAAgB,SAAS,OAAO,CAAC,GAAG,CAAC,uBACvC,SAAS,OAAO,CAAC,GAAG,CAAC,uBACrB,SAAS,OAAO,CAAC,GAAG,CAAC,qBACrB,SAAS,OAAO,CAAC,GAAG,CAAC;QAEzB,4BAA4B;QAC5B,MAAM,cAAc,SAAS,OAAO,CAAC,GAAG,CAAC;QACzC,MAAM,SAAS,eAAe,YAAY,QAAQ,CAAC;QAEnD,iBAAiB;QACjB,MAAM,OAAO,SAAS,MAAM,SAAS,IAAI,KAAK,MAAM,SAAS,IAAI;QAEjE,sCAAsC;QACtC,IAAI,SAAS,MAAM,KAAK,KAAK;YACzB,QAAQ,GAAG,CAAC,0BAA0B,KAAK,SAAS,CAAC,MAAM,MAAM;YAEjE,IAAI,MAAM,SAAS,KAAK;gBACpB,QAAQ,GAAG,CAAC,sBAAsB,KAAK,OAAO,CAAC,GAAG;gBAClD,MAAM,IAAI,yIAAwB,CAC9B,KAAK,OAAO,CAAC,GAAG,EAChB,KAAK,OAAO,CAAC,OAAO,IAAI;YAEhC;YAEA,MAAM,aAAa,MAAM,cAAc,MAAM,SAAS;YACtD,IAAI,YAAY;gBACZ,QAAQ,GAAG,CAAC,yBAAyB;gBACrC,MAAM,IAAI,yIAAwB,CAAC;YACvC;QACJ;QAEA,uDAAuD;QACvD,IAAI,CAAC,SAAS,EAAE,EAAE;YACd,QAAQ,GAAG,CAAC,CAAC,MAAM,EAAE,SAAS,MAAM,CAAC,eAAe,CAAC,EAAE,KAAK,SAAS,CAAC,MAAM,MAAM;YAElF,sDAAsD;YACtD,QAAQ,GAAG,CAAC;YACZ,KAAK,MAAM,CAAC,KAAK,MAAM,IAAI,SAAS,OAAO,CAAE;gBACzC,QAAQ,GAAG,CAAC,GAAG,IAAI,EAAE,EAAE,OAAO;YAClC;YAIA,kEAAkE;YAClE,MAAM,eAAe,CAAC,oBAAoB,EAAE,SAAS,MAAM,CAAC,GAAG,EAAE,SAAS,UAAU,IAAI,cAAc;YAEtG,QAAQ,GAAG,CAAC,wBAAwB;YACpC,MAAM,IAAI,SAAS,cAAc,eAAe,SAAS,MAAM;QACnE;QAEA,eAAe;QACf,QAAQ,GAAG,CAAC,qCAAqC;QACjD,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,2BAA2B;QAC3B,IAAI,iBAAiB,yIAAwB,IAAI,iBAAiB,UAAU;YACxE,MAAM;QACV;QAEA,QAAQ,KAAK,CAAC,sBAAsB;QACpC,MAAM;IACV;AACJ","debugId":null}},
    {"offset": {"line": 860, "column": 0}, "map": {"version":3,"sources":["file:///Users/srozemuller/Repos/IntuneAssistant/IntuneAssistant.WebInterface/hooks/useApiRequest.ts"],"sourcesContent":["// hooks/useApiRequest.ts\nimport { useRef, useCallback } from 'react';\nimport { useMsal } from '@azure/msal-react';\nimport { useConsent } from \"@/contexts/ConsentContext\";\nimport { useTenant } from \"@/contexts/TenantContext\";\nimport { apiRequest, ApiError } from \"@/lib/apiRequest\";\nimport { apiScope } from '@/lib/msalConfig';\nimport { UserConsentRequiredError } from '@/lib/errors';\nimport { useError } from '@/contexts/ErrorContext';\n\nexport function useApiRequest() {\n    const { instance, accounts } = useMsal();\n    const { showConsent } = useConsent();\n    const { showError, clearError } = useError();\n    const { selectedTenant } = useTenant();\n    const abortControllerRef = useRef<AbortController | null>(null);\n\n    const request = useCallback(async function<T>(\n        url: string,\n        options: RequestInit = {},\n        onConsentComplete?: () => Promise<T>\n    ): Promise<T | undefined> {\n        // Cancel previous request if still running\n        clearError();\n\n        if (abortControllerRef.current) {\n            abortControllerRef.current.abort();\n        }\n\n        // Create new abort controller\n        abortControllerRef.current = new AbortController();\n\n        try {\n            // Get access token\n            let accessToken: string | undefined;\n            if (accounts.length > 0) {\n                const response = await instance.acquireTokenSilent({\n                    scopes: [apiScope],\n                    account: accounts[0],\n                });\n                accessToken = response.accessToken;\n            }\n\n            // Add tenant header and signal to options\n            const requestOptions = {\n                ...options,\n                signal: abortControllerRef.current.signal,\n                headers: {\n                    ...options.headers,\n                    ...(selectedTenant && { 'X-Tenant-ID': selectedTenant.tenantId })\n                }\n            };\n\n            return await apiRequest<T>(url, requestOptions, accessToken);\n        } catch (err) {\n            if (err instanceof Error && err.name === 'AbortError') {\n                return;\n            }\n\n            if (err instanceof UserConsentRequiredError) {\n                console.log(\"Consent required, showing consent dialog with URL:\", err.consentUrl);\n                showConsent(err.consentUrl, onConsentComplete ?\n                    async () => {\n                        try {\n                            return await onConsentComplete();\n                        } catch (retryError) {\n                            console.error(\"Error retrying request after consent:\", retryError);\n                            const retryErrorMessage = retryError instanceof Error ? retryError.message : 'Retry failed';\n                            showError(retryErrorMessage);\n                        }\n                    } : undefined\n                );\n                return;\n            }\n\n            // Handle ApiError with correlation ID\n            let errorMessage = err instanceof Error ? err.message : 'An error occurred';\n\n            if (err instanceof ApiError && err.correlationId) {\n                errorMessage = `${errorMessage} (Correlation ID: ${err.correlationId})`;\n                console.log('Error with correlation ID:', err.correlationId);\n            }\n\n            // Show error through global error handler\n            showError(errorMessage, onConsentComplete ? async () => {\n                try {\n                    return await onConsentComplete();\n                } catch (retryError) {\n                    console.error(\"Error retrying request after consent:\", retryError);\n                    const retryErrorMessage = retryError instanceof Error ? retryError.message : 'Retry failed';\n                    showError(retryErrorMessage);\n                }\n            } : undefined);\n\n            return;\n        }\n    }, [instance, accounts, showConsent, selectedTenant, showError, clearError]);\n\n    const cancel = useCallback(() => {\n        if (abortControllerRef.current) {\n            abortControllerRef.current.abort();\n            abortControllerRef.current = null;\n        }\n    }, []);\n\n    return { request, cancel };\n}\n"],"names":[],"mappings":"AAAA,yBAAyB;;;;;AACzB;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AAEO,SAAS;IACZ,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,IAAA,+KAAO;IACtC,MAAM,EAAE,WAAW,EAAE,GAAG,IAAA,yIAAU;IAClC,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,IAAA,qIAAQ;IAC1C,MAAM,EAAE,cAAc,EAAE,GAAG,IAAA,uIAAS;IACpC,MAAM,qBAAqB,IAAA,+MAAM,EAAyB;IAE1D,MAAM,UAAU,IAAA,oNAAW,EAAC,eACxB,GAAW,EACX,UAAuB,CAAC,CAAC,EACzB,iBAAoC;QAEpC,2CAA2C;QAC3C;QAEA,IAAI,mBAAmB,OAAO,EAAE;YAC5B,mBAAmB,OAAO,CAAC,KAAK;QACpC;QAEA,8BAA8B;QAC9B,mBAAmB,OAAO,GAAG,IAAI;QAEjC,IAAI;YACA,mBAAmB;YACnB,IAAI;YACJ,IAAI,SAAS,MAAM,GAAG,GAAG;gBACrB,MAAM,WAAW,MAAM,SAAS,kBAAkB,CAAC;oBAC/C,QAAQ;wBAAC,6HAAQ;qBAAC;oBAClB,SAAS,QAAQ,CAAC,EAAE;gBACxB;gBACA,cAAc,SAAS,WAAW;YACtC;YAEA,0CAA0C;YAC1C,MAAM,iBAAiB;gBACnB,GAAG,OAAO;gBACV,QAAQ,mBAAmB,OAAO,CAAC,MAAM;gBACzC,SAAS;oBACL,GAAG,QAAQ,OAAO;oBAClB,GAAI,kBAAkB;wBAAE,eAAe,eAAe,QAAQ;oBAAC,CAAC;gBACpE;YACJ;YAEA,OAAO,MAAM,IAAA,+HAAU,EAAI,KAAK,gBAAgB;QACpD,EAAE,OAAO,KAAK;YACV,IAAI,eAAe,SAAS,IAAI,IAAI,KAAK,cAAc;gBACnD;YACJ;YAEA,IAAI,eAAe,yIAAwB,EAAE;gBACzC,QAAQ,GAAG,CAAC,sDAAsD,IAAI,UAAU;gBAChF,YAAY,IAAI,UAAU,EAAE,oBACxB;oBACI,IAAI;wBACA,OAAO,MAAM;oBACjB,EAAE,OAAO,YAAY;wBACjB,QAAQ,KAAK,CAAC,yCAAyC;wBACvD,MAAM,oBAAoB,sBAAsB,QAAQ,WAAW,OAAO,GAAG;wBAC7E,UAAU;oBACd;gBACJ,IAAI;gBAER;YACJ;YAEA,sCAAsC;YACtC,IAAI,eAAe,eAAe,QAAQ,IAAI,OAAO,GAAG;YAExD,IAAI,eAAe,6HAAQ,IAAI,IAAI,aAAa,EAAE;gBAC9C,eAAe,GAAG,aAAa,kBAAkB,EAAE,IAAI,aAAa,CAAC,CAAC,CAAC;gBACvE,QAAQ,GAAG,CAAC,8BAA8B,IAAI,aAAa;YAC/D;YAEA,0CAA0C;YAC1C,UAAU,cAAc,oBAAoB;gBACxC,IAAI;oBACA,OAAO,MAAM;gBACjB,EAAE,OAAO,YAAY;oBACjB,QAAQ,KAAK,CAAC,yCAAyC;oBACvD,MAAM,oBAAoB,sBAAsB,QAAQ,WAAW,OAAO,GAAG;oBAC7E,UAAU;gBACd;YACJ,IAAI;YAEJ;QACJ;IACJ,GAAG;QAAC;QAAU;QAAU;QAAa;QAAgB;QAAW;KAAW;IAE3E,MAAM,SAAS,IAAA,oNAAW,EAAC;QACvB,IAAI,mBAAmB,OAAO,EAAE;YAC5B,mBAAmB,OAAO,CAAC,KAAK;YAChC,mBAAmB,OAAO,GAAG;QACjC;IACJ,GAAG,EAAE;IAEL,OAAO;QAAE;QAAS;IAAO;AAC7B","debugId":null}},
    {"offset": {"line": 978, "column": 0}, "map": {"version":3,"sources":["file:///Users/srozemuller/Repos/IntuneAssistant/IntuneAssistant.WebInterface/hooks/useGdapTenantOnboarding.ts"],"sourcesContent":["import { useState, useCallback } from 'react';\nimport {PARTNER_TENANTS_ENDPOINT, CONSENT_URL_ENDPOINT} from '@/lib/constants';\nimport {useApiRequest} from \"@/hooks/useApiRequest\";\nimport {apiScope} from \"@/lib/msalConfig\";\nimport {useMsal} from \"@azure/msal-react\";\n\nexport interface PartnerTenant {\n    tenantId: string;\n    displayName: string;\n    domain: string;\n    country: string;\n    createdDateTime: string | null;\n    isOnboarded: boolean;\n    isLinked: boolean;\n}\n\ninterface ApiResponse {\n    message: string | { url: string; message: string }; // Updated to handle both cases\n    details: string;\n    data: PartnerTenant[];\n    status: string;\n}\n\nexport const useGdapTenantOnboarding = (partnerTenantId?: string) => {\n    const [partnerTenants, setPartnerTenants] = useState<PartnerTenant[]>([]);\n    const [selectedTenant, setSelectedTenant] = useState<PartnerTenant | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n    const { request } = useApiRequest();\n\n    const fetchPartnerTenants = useCallback(async (): Promise<ApiResponse> => {\n        if (!partnerTenantId) {\n            setError('Your tenant ID is required to fetch partner tenants');\n            throw new Error('Your tenant ID is required to fetch partner tenants');\n        }\n\n        setLoading(true);\n        setError(null);\n\n        try {\n            const data = await request<ApiResponse>(\n                PARTNER_TENANTS_ENDPOINT,\n                {\n                    method: 'GET',\n                    headers: {\n                        'X-Tenant-ID': partnerTenantId,\n                        'Content-Type': 'application/json'\n                    }\n                },\n                fetchPartnerTenants\n            );\n\n            // Handle the case where data might be undefined\n            if (!data) {\n                throw new Error('No data received from API');\n            }\n\n            if (data.status === 'Success' && Array.isArray(data.data)) {\n                setPartnerTenants(data.data);\n                setError(null);\n            } else if (data.message) {\n                const errorMessage = typeof data.message === 'string'\n                    ? data.message\n                    : 'Failed to fetch partner tenants';\n                setError(errorMessage);\n            }\n\n            return data;\n        } catch (error) {\n            console.error('Failed to fetch partner tenants:', error);\n            setError('Failed to fetch partner tenants');\n            throw error;\n        } finally {\n            setLoading(false);\n        }\n    }, [partnerTenantId, request]);\n\n\n\n    const resetSelection = useCallback(() => {\n        setSelectedTenant(null);\n        setPartnerTenants([]);\n        setError(null);\n    }, []);\n\n    return {\n        partnerTenants,\n        selectedTenant,\n        setSelectedTenant,\n        loading,\n        error,\n        fetchPartnerTenants,\n        resetSelection\n    };\n};\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAqBO,MAAM,0BAA0B,CAAC;IACpC,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAkB,EAAE;IACxE,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAuB;IAC3E,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAClD,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,uIAAa;IAEjC,MAAM,sBAAsB,IAAA,oNAAW,EAAC;QACpC,IAAI,CAAC,iBAAiB;YAClB,SAAS;YACT,MAAM,IAAI,MAAM;QACpB;QAEA,WAAW;QACX,SAAS;QAET,IAAI;YACA,MAAM,OAAO,MAAM,QACf,4IAAwB,EACxB;gBACI,QAAQ;gBACR,SAAS;oBACL,eAAe;oBACf,gBAAgB;gBACpB;YACJ,GACA;YAGJ,gDAAgD;YAChD,IAAI,CAAC,MAAM;gBACP,MAAM,IAAI,MAAM;YACpB;YAEA,IAAI,KAAK,MAAM,KAAK,aAAa,MAAM,OAAO,CAAC,KAAK,IAAI,GAAG;gBACvD,kBAAkB,KAAK,IAAI;gBAC3B,SAAS;YACb,OAAO,IAAI,KAAK,OAAO,EAAE;gBACrB,MAAM,eAAe,OAAO,KAAK,OAAO,KAAK,WACvC,KAAK,OAAO,GACZ;gBACN,SAAS;YACb;YAEA,OAAO;QACX,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,oCAAoC;YAClD,SAAS;YACT,MAAM;QACV,SAAU;YACN,WAAW;QACf;IACJ,GAAG;QAAC;QAAiB;KAAQ;IAI7B,MAAM,iBAAiB,IAAA,oNAAW,EAAC;QAC/B,kBAAkB;QAClB,kBAAkB,EAAE;QACpB,SAAS;IACb,GAAG,EAAE;IAEL,OAAO;QACH;QACA;QACA;QACA;QACA;QACA;QACA;IACJ;AACJ","debugId":null}},
    {"offset": {"line": 1051, "column": 0}, "map": {"version":3,"sources":["file:///Users/srozemuller/Repos/IntuneAssistant/IntuneAssistant.WebInterface/components/ui/command.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { SearchIcon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\"\n\nfunction Command({\n  className,\n  ...props\n}: React.ComponentProps<typeof CommandPrimitive>) {\n  return (\n    <CommandPrimitive\n      data-slot=\"command\"\n      className={cn(\n        \"bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CommandDialog({\n  title = \"Command Palette\",\n  description = \"Search for a command to run...\",\n  children,\n  className,\n  showCloseButton = true,\n  ...props\n}: React.ComponentProps<typeof Dialog> & {\n  title?: string\n  description?: string\n  className?: string\n  showCloseButton?: boolean\n}) {\n  return (\n    <Dialog {...props}>\n      <DialogHeader className=\"sr-only\">\n        <DialogTitle>{title}</DialogTitle>\n        <DialogDescription>{description}</DialogDescription>\n      </DialogHeader>\n      <DialogContent\n        className={cn(\"overflow-hidden p-0\", className)}\n        showCloseButton={showCloseButton}\n      >\n        <Command className=\"[&_[cmdk-group-heading]]:text-muted-foreground **:data-[slot=command-input-wrapper]:h-12 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group]]:px-2 [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nfunction CommandInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof CommandPrimitive.Input>) {\n  return (\n    <div\n      data-slot=\"command-input-wrapper\"\n      className=\"flex h-9 items-center gap-2 border-b px-3\"\n    >\n      <SearchIcon className=\"size-4 shrink-0 opacity-50\" />\n      <CommandPrimitive.Input\n        data-slot=\"command-input\"\n        className={cn(\n          \"placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n}\n\nfunction CommandList({\n  className,\n  ...props\n}: React.ComponentProps<typeof CommandPrimitive.List>) {\n  return (\n    <CommandPrimitive.List\n      data-slot=\"command-list\"\n      className={cn(\n        \"max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CommandEmpty({\n  ...props\n}: React.ComponentProps<typeof CommandPrimitive.Empty>) {\n  return (\n    <CommandPrimitive.Empty\n      data-slot=\"command-empty\"\n      className=\"py-6 text-center text-sm\"\n      {...props}\n    />\n  )\n}\n\nfunction CommandGroup({\n  className,\n  ...props\n}: React.ComponentProps<typeof CommandPrimitive.Group>) {\n  return (\n    <CommandPrimitive.Group\n      data-slot=\"command-group\"\n      className={cn(\n        \"text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CommandSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof CommandPrimitive.Separator>) {\n  return (\n    <CommandPrimitive.Separator\n      data-slot=\"command-separator\"\n      className={cn(\"bg-border -mx-1 h-px\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CommandItem({\n  className,\n  ...props\n}: React.ComponentProps<typeof CommandPrimitive.Item>) {\n  return (\n    <CommandPrimitive.Item\n      data-slot=\"command-item\"\n      className={cn(\n        \"data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CommandShortcut({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) {\n  return (\n    <span\n      data-slot=\"command-shortcut\"\n      className={cn(\n        \"text-muted-foreground ml-auto text-xs tracking-widest\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAGA;AACA;AAEA;AACA;AAPA;;;;;;AAeA,SAAS,QAAQ,EACf,SAAS,EACT,GAAG,OAC2C;IAC9C,qBACE,8OAAC,iJAAgB;QACf,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,6FACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,cAAc,EACrB,QAAQ,iBAAiB,EACzB,cAAc,gCAAgC,EAC9C,QAAQ,EACR,SAAS,EACT,kBAAkB,IAAI,EACtB,GAAG,OAMJ;IACC,qBACE,8OAAC,qIAAM;QAAE,GAAG,KAAK;;0BACf,8OAAC,2IAAY;gBAAC,WAAU;;kCACtB,8OAAC,0IAAW;kCAAE;;;;;;kCACd,8OAAC,gJAAiB;kCAAE;;;;;;;;;;;;0BAEtB,8OAAC,4IAAa;gBACZ,WAAW,IAAA,kHAAE,EAAC,uBAAuB;gBACrC,iBAAiB;0BAEjB,cAAA,8OAAC;oBAAQ,WAAU;8BAChB;;;;;;;;;;;;;;;;;AAKX;AAEA,SAAS,aAAa,EACpB,SAAS,EACT,GAAG,OACiD;IACpD,qBACE,8OAAC;QACC,aAAU;QACV,WAAU;;0BAEV,8OAAC,wNAAU;gBAAC,WAAU;;;;;;0BACtB,8OAAC,iJAAgB,CAAC,KAAK;gBACrB,aAAU;gBACV,WAAW,IAAA,kHAAE,EACX,4JACA;gBAED,GAAG,KAAK;;;;;;;;;;;;AAIjB;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,8OAAC,iJAAgB,CAAC,IAAI;QACpB,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,+DACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,aAAa,EACpB,GAAG,OACiD;IACpD,qBACE,8OAAC,iJAAgB,CAAC,KAAK;QACrB,aAAU;QACV,WAAU;QACT,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,aAAa,EACpB,SAAS,EACT,GAAG,OACiD;IACpD,qBACE,8OAAC,iJAAgB,CAAC,KAAK;QACrB,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,0NACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,iBAAiB,EACxB,SAAS,EACT,GAAG,OACqD;IACxD,qBACE,8OAAC,iJAAgB,CAAC,SAAS;QACzB,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,wBAAwB;QACrC,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,8OAAC,iJAAgB,CAAC,IAAI;QACpB,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,uYACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EACvB,SAAS,EACT,GAAG,OAC0B;IAC7B,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,yDACA;QAED,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 1242, "column": 0}, "map": {"version":3,"sources":["file:///Users/srozemuller/Repos/IntuneAssistant/IntuneAssistant.WebInterface/components/onboarding/tenant-onboarding.tsx"],"sourcesContent":["'use client';\nimport { useState, useEffect } from 'react';\nimport { useMsal } from '@azure/msal-react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Switch } from '@/components/ui/switch';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport {\n    Info, Users, Building, Lock, AlertCircle, Loader2, CheckCircle,\n    Shield, ExternalLink, X\n} from 'lucide-react';\nimport { useGdapTenantOnboarding, type PartnerTenant } from '@/hooks/useGdapTenantOnboarding';\nimport { Command, CommandEmpty, CommandGroup, CommandInput, CommandItem, CommandList } from '@/components/ui/command';\nimport {CONSENT_URL_ENDPOINT, CONSENT_CALLBACK, CUSTOMER_ENDPOINT} from '@/lib/constants';\nimport { apiScope } from '@/lib/msalConfig';\n\ninterface TenantOnboardingModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    customerId: string;\n    customerName: string;\n    onSuccess: () => void;\n    gdapTenant?: PartnerTenant;\n    type?: 'regular' | 'gdap';\n}\n\ninterface OnboardingResult {\n    status: string;\n    message: string;\n    data?: string;\n}\n\nconst TenantOnboardingModal: React.FC<TenantOnboardingModalProps> = ({\n                                                                         isOpen,\n                                                                         onClose,\n                                                                         customerId,\n                                                                         customerName,\n                                                                         onSuccess,\n                                                                         gdapTenant,\n                                                                         type = 'regular'\n                                                                     }) => {\n    // State management\n    const {instance, accounts} = useMsal();\n    const [consentState, setConsentState] = useState<string | null>(null);\n    const [onboardingResult, setOnboardingResult] = useState<OnboardingResult | null>(null);\n\n    const [currentStep, setCurrentStep] = useState(0);\n    const [isGdapMode, setIsGdapMode] = useState(true);\n    const [tenantId, setTenantId] = useState(gdapTenant?.tenantId || '');\n    const [tenantDomainName, setTenantDomainName] = useState(gdapTenant?.domain || '');\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n    const [consentWindow, setConsentWindow] = useState<Window | null>(null);\n    const [consentCompleted, setConsentCompleted] = useState(false);\n\n    const loggedInUserTenantId = accounts[0]?.tenantId || accounts[0]?.homeAccountId?.split('.')[1];\n\n    const {\n        partnerTenants,\n        selectedTenant,\n        setSelectedTenant,\n        loading: gdapLoading,\n        error: gdapError,\n        fetchPartnerTenants,\n        resetSelection\n    } = useGdapTenantOnboarding(loggedInUserTenantId);\n\n    // Initialize component when opening\n    useEffect(() => {\n        if (isOpen) {\n            if (gdapTenant) {\n                setIsGdapMode(true);\n                setTenantId(gdapTenant.tenantId);\n                setTenantDomainName(gdapTenant.domain);\n                setCurrentStep(1); // Skip step 0 for pre-selected GDAP tenant\n            } else {\n                setCurrentStep(0);\n                setIsGdapMode(true); // Always default to GDAP\n                setTenantId('');\n                setTenantDomainName('');\n            }\n            setError(null);\n            setConsentCompleted(false);\n            resetSelection();\n        }\n    }, [isOpen, gdapTenant, type, resetSelection]);\n\n    // Handle consent window messages\n    useEffect(() => {\n        const handleMessage = (event: MessageEvent) => {\n            if (event.origin !== window.location.origin) {\n                console.log('Message from different origin ignored:', event.origin);\n                return;\n            }\n            if (event.data.type === 'CONSENT_SUCCESS') {\n                console.log('Consent success received');\n                setConsentCompleted(true);\n                setLoading(false);\n\n                if (consentWindow) {\n                    consentWindow.close();\n                    setConsentWindow(null);\n                }\n                handleConsentCallback();\n\n            } else if (event.data.type === 'CONSENT_ERROR') {\n                console.log('Consent error received:', event.data);\n                setError(`Consent failed: ${event.data.errorDescription || event.data.error || 'Unknown error'}`);\n                setLoading(false);\n\n                if (consentWindow) {\n                    consentWindow.close();\n                    setConsentWindow(null);\n                }\n            }\n        };\n\n        window.addEventListener('message', handleMessage);\n        return () => window.removeEventListener('message', handleMessage);\n    }, [consentWindow]);\n\n    // Monitor consent window closure\n    useEffect(() => {\n        if (!consentWindow) return;\n\n        const checkClosed = setInterval(() => {\n            if (consentWindow.closed && !consentCompleted) {\n                console.log('Consent window closed without completion');\n                setError('Consent window was closed. Please try again.');\n                setLoading(false);\n                setConsentWindow(null);\n            }\n        }, 1000);\n\n        return () => clearInterval(checkClosed);\n    }, [consentWindow, consentCompleted]);\n\n    const linkExistingTenant = async () => {\n        try {\n            setLoading(true);\n            setError(null);\n\n            const finalTenantId = isGdapMode ? selectedTenant?.tenantId : tenantId;\n\n            if (!finalTenantId) {\n                throw new Error('Missing tenant ID');\n            }\n\n            const token = await instance.acquireTokenSilent({\n                scopes: [apiScope],\n                account: accounts[0]\n            });\n\n            const response = await fetch(\n                `${CUSTOMER_ENDPOINT}/tenants`,\n                {\n                    method: 'POST',\n                    headers: {\n                        'Authorization': `Bearer ${token.accessToken}`,\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        isEnabled: true,\n                        isGdap: isGdapMode,\n                        tenantId: finalTenantId\n                    })\n                }\n            );\n\n            if (!response.ok) {\n                const errorData = await response.json().catch(() => null);\n                throw new Error(errorData?.message || `Failed to link tenant: ${response.statusText}`);\n            }\n\n            const result = await response.json();\n            console.log('Tenant linked successfully:', result);\n\n            setOnboardingResult({\n                status: 'success',\n                message: 'Tenant linked successfully'\n            });\n            setCurrentStep(3);\n        } catch (err) {\n            console.error('Error linking tenant:', err);\n            setError(err instanceof Error ? err.message : 'Failed to link tenant');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n\n    const handleConsentCallback = async () => {\n        try {\n            setLoading(true);\n            setError(null);\n\n            console.log('Processing consent callback...');\n\n            // Wait a moment for the consent to be processed\n            await new Promise(resolve => setTimeout(resolve, 2000));\n\n            const token = await instance.acquireTokenSilent({\n                scopes: [apiScope],\n                account: accounts[0]\n            });\n\n            // Check onboarding status or complete the process\n            const response = await fetch(\n                `${CONSENT_CALLBACK}${consentState ? `?state=${consentState}` : ''}`,\n                {\n                    method: 'GET',\n                    headers: {\n                        'Authorization': `Bearer ${token.accessToken}`,\n                        'Content-Type': 'application/json',\n                    }\n                }\n            );\n\n            if (!response.ok) {\n                const errorData = await response.json().catch(() => null);\n                throw new Error(errorData?.message || `Failed to complete onboarding: ${response.statusText}`);\n            }\n\n            let result = null;\n            if (response.status === 204) {\n                console.log('Onboarding completed (204 No Content)');\n                result = { status: 'success', message: 'Onboarding completed successfully' };\n            } else {\n                result = await response.json();\n                console.log('Onboarding completed:', result);\n            }\n\n            setOnboardingResult(result);\n            setCurrentStep(3);\n        } catch (err) {\n            console.error('Error completing onboarding:', err);\n            setError(err instanceof Error ? err.message : 'Failed to complete onboarding');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n\n    // Step navigation\n    const handleNext = () => {\n        setError(null);\n\n        if (currentStep === 0) {\n            // Step 1: Method selection and data entry\n            if (isGdapMode && !selectedTenant) {\n                setError('Please select a partner tenant for GDAP onboarding');\n                return;\n            }\n            if (!isGdapMode && (!tenantId || !tenantDomainName)) {\n                setError('Please enter tenant ID and domain name');\n                return;\n            }\n            setCurrentStep(1);\n        } else if (currentStep === 1) {\n            // Check if tenant is already onboarded but not linked\n            const isOnboardedNotLinked = isGdapMode\n                ? selectedTenant?.isOnboarded && !selectedTenant?.isLinked\n                : false; // For manual entry, we can't determine this easily\n\n            if (isOnboardedNotLinked) {\n                // Skip consent step and go directly to linking\n                linkExistingTenant();\n            } else {\n                // Step 2: Validation -> Admin Consent\n                setCurrentStep(2);\n                initiateConsent();\n            }\n        } else if (currentStep === 2) {\n            // This step is handled by consent completion\n            setCurrentStep(3);\n        }\n    };\n\n    const handleBack = () => {\n        if (currentStep > 0) {\n            setCurrentStep(currentStep - 1);\n        }\n    };\n\n    const initiateConsent = async () => {\n        try {\n            setLoading(true);\n            setError(null);\n\n            const finalTenantId = isGdapMode ? selectedTenant?.tenantId : tenantId;\n            const finalDomainName = isGdapMode ? selectedTenant?.domain : tenantDomainName;\n            const finalDisplayName = isGdapMode ? selectedTenant?.displayName : undefined;\n\n            console.log('Initiating consent for tenant:', {\n                tenantId: finalTenantId,\n                domainName: finalDomainName,\n                displayName: finalDisplayName,\n                isGdap: isGdapMode\n            });\n\n            if (!finalTenantId || !finalDomainName) {\n                throw new Error('Missing tenant information');\n            }\n            const tokenResponse = await instance.acquireTokenSilent({\n                scopes: [apiScope],\n                account: accounts[0]\n            });\n\n            // Build API URL to get consent URL\n            const apiUrl = `${CUSTOMER_ENDPOINT}/${customerId}/tenants/onboarding?tenantid=${finalTenantId}&tenantName=${finalDisplayName}&domainName=${encodeURIComponent(finalDomainName)}&isGdap=${isGdapMode}`;\n            console.log(' API URL:', apiUrl);\n\n            // Make API call to get consent URL\n            const response = await fetch(apiUrl, {\n                method: 'GET',\n                headers: {\n                    'Authorization': `Bearer ${tokenResponse.accessToken}`,\n                    'Content-Type': 'application/json',\n                },\n            });\n\n            if (!response.ok) {\n                const errorData = await response.json().catch(() => null);\n                throw new Error(errorData?.message || `Failed to get consent URL: ${response.statusText}`);\n            }\n\n            const result = await response.json();\n            console.log(' API Response:', result);\n\n            // Extract consent URL from API response\n            const consentUrl = result.data?.url || result.url;\n            if (!consentUrl) {\n                throw new Error('No consent URL received from API');\n            }\n            const state = extractStateFromConsentUrl(result.data.url);\n            setConsentState(state);\n            console.log(' Opening consent URL:', consentUrl);\n\n            // Open consent window with the URL from API\n            const popup = window.open(\n                consentUrl,\n                'consentWindow',\n                'width=600,height=700,scrollbars=yes,resizable=yes,status=yes,location=yes,toolbar=no,menubar=no'\n            );\n\n            if (popup) {\n                setConsentWindow(popup);\n                popup.focus();\n            } else {\n                throw new Error('Failed to open consent window. Please check your popup blocker settings.');\n            }\n\n        } catch (err) {\n            console.error('Error initiating consent:', err);\n            setError(err instanceof Error ? err.message : 'Failed to initiate consent');\n            setLoading(false);\n        }\n    };\n\n    const extractStateFromConsentUrl = (url: string): string | null => {\n        try {\n            const urlObj = new URL(url);\n            return urlObj.searchParams.get('state');\n        } catch (error) {\n            console.error('Failed to parse consent URL:', error);\n            return null;\n        }\n    };\n\n    const handleComplete = () => {\n        onSuccess();\n        onClose();\n    };\n\n    // Step content rendering\n    const renderStepContent = () => {\n        switch (currentStep) {\n            case 0:\n                return (\n                    <Card>\n                        <CardHeader>\n                            <CardTitle>Step 1: Choose Onboarding Method</CardTitle>\n                            <CardDescription>Select how you want to onboard this tenant</CardDescription>\n                        </CardHeader>\n                        <CardContent className=\"space-y-6\">\n                            {/* Method Selection */}\n                            <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                                <div className=\"flex-1\">\n                                    <div className=\"flex items-center gap-2 mb-2\">\n                                        <h4 className=\"font-medium\">Authentication Method</h4>\n                                        <Info className=\"h-4 w-4 text-blue-500\" />\n                                    </div>\n                                    <div className=\"space-y-2\">\n                                        <div className=\"flex items-center gap-3\">\n                                            <Switch\n                                                checked={isGdapMode}\n                                                onCheckedChange={(checked) => {\n                                                    setIsGdapMode(checked);\n                                                    setError(null);\n                                                    // Reset selections when switching modes\n                                                    if (!checked) {\n                                                        setSelectedTenant(null);\n                                                        resetSelection();\n                                                    }\n                                                    setTenantId('');\n                                                    setTenantDomainName('');\n                                                }}\n                                                disabled={true}\n                                            />\n\n                                            <span className=\"font-medium\">\n                    {isGdapMode ? 'GDAP (Recommended)' : 'Interactive Authentication'}\n                </span>\n                                        </div>\n                                        <div className=\"text-sm text-gray-600 ml-8\">\n                                            {isGdapMode ? (\n                                                <span>\n                        Use Granular Delegated Admin Privileges for secure partner access.\n                        Select from your existing GDAP relationships.\n                    </span>\n                                            ) : (\n                                                <span>\n                        Traditional interactive authentication requiring customer admin consent.\n                        Enter tenant details manually.\n                    </span>\n                                            )}\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n\n\n                            {/* GDAP Tenant Selection */}\n                            {isGdapMode && (\n                                <Card className=\"border-primary/20 bg-primary/5\">\n                                    <CardHeader>\n                                        <div className=\"flex items-center justify-between\">\n                                            <div>\n                                                <CardTitle className=\"flex items-center gap-2\">\n                                                    <Shield className=\"h-5 w-5\" />\n                                                    Select Partner Tenant\n                                                </CardTitle>\n                                                <CardDescription>\n                                                    Choose from your available GDAP partner tenants\n                                                </CardDescription>\n                                            </div>\n                                            <Button\n                                                variant=\"outline\"\n                                                size=\"sm\"\n                                                onClick={fetchPartnerTenants}\n                                                disabled={gdapLoading}\n                                            >\n                                                {gdapLoading ? (\n                                                    <Loader2 className=\"h-4 w-4 animate-spin\" />\n                                                ) : (\n                                                    'Refresh'\n                                                )}\n                                            </Button>\n                                        </div>\n                                    </CardHeader>\n                                    <CardContent className=\"space-y-4\">\n                                        {partnerTenants.length === 0 && !gdapLoading && !gdapError && (\n                                            <Button onClick={fetchPartnerTenants} >\n                                                Load Partner Tenants\n                                            </Button>\n                                        )}\n\n                                        {gdapLoading && (\n                                            <div className=\"text-center py-4\">\n                                                <Loader2 className=\"h-6 w-6 animate-spin mx-auto mb-2\" />\n                                                <p className=\"text-sm text-gray-600\">Loading partner tenants...</p>\n                                            </div>\n                                        )}\n\n                                        {gdapError && (\n                                            <div className=\"flex items-center gap-2 text-sm text-red-600 bg-red-50 p-3 rounded-md\">\n                                                <AlertCircle className=\"h-4 w-4\" />\n                                                {gdapError}\n                                            </div>\n                                        )}\n\n                                        {!gdapLoading && !gdapError && partnerTenants.length > 0 && (\n                                            <Command className=\"rounded-lg border shadow-md\">\n                                                <CommandInput placeholder=\"Search tenants...\" />\n                                                <CommandList className=\"max-h-[300px]\">\n                                                    <CommandEmpty>No tenants found.</CommandEmpty>\n                                                    <CommandGroup>\n                                                        {partnerTenants.map((tenant) => (\n                                                            <CommandItem\n                                                                key={tenant.tenantId}\n                                                                value={`${tenant.domain} ${tenant.displayName || ''}`}\n                                                                onSelect={() => {\n                                                                    setSelectedTenant(tenant);\n                                                                    setTenantId(tenant.tenantId);\n                                                                    setTenantDomainName(tenant.domain);\n                                                                }}\n                                                                disabled={tenant.isLinked}\n                                                                className={`flex items-center justify-between p-3 cursor-pointer hover:bg-gray-50 ${\n                                                                    tenant.isLinked ? 'opacity-50 cursor-not-allowed hover:bg-transparent' : ''\n                                                                }`}\n                                                            >\n                                                                <div className=\"flex-1\">\n                                                                    <div className=\"flex items-center gap-2\">\n                                                                        <p className=\"font-medium\">{tenant.domain}</p>\n                                                                        {tenant.displayName && (\n                                                                            <span className=\"text-sm text-gray-500\">\n                        ({tenant.displayName})\n                    </span>\n                                                                        )}\n                                                                    </div>\n                                                                    <p className=\"text-xs text-gray-400 font-mono\">\n                                                                        {tenant.tenantId}\n                                                                    </p>\n                                                                    <div className=\"flex gap-1 mt-1\">\n                                                                        <Badge\n                                                                            variant={tenant.isOnboarded ? \"default\" : \"secondary\"}\n                                                                            className=\"text-xs\"\n                                                                        >\n                                                                            {tenant.isOnboarded ? 'Onboarded' : 'Not Onboarded'}\n                                                                        </Badge>\n                                                                        <Badge\n                                                                            variant=\"secondary\"\n                                                                            className={`text-xs ${tenant.isLinked ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' : ''}`}\n                                                                        >\n                                                                            {tenant.isLinked ? 'Linked' : 'Not Linked'}\n                                                                        </Badge>\n                                                                    </div>\n                                                                </div>\n                                                                {selectedTenant?.tenantId === tenant.tenantId && (\n                                                                    <CheckCircle className=\"h-5 w-5 text-green-600\" />\n                                                                )}\n                                                            </CommandItem>\n                                                        ))}\n                                                    </CommandGroup>\n                                                </CommandList>\n                                            </Command>\n                                        )}\n\n                                        {selectedTenant && (\n                                            <Card className=\"bg-green-50 border-green-200\">\n                                                <CardContent className=\"p-4\">\n                                                    <div className=\"flex items-center justify-between\">\n                                                        <div>\n                                                            <p className=\"font-medium text-green-800\">\n                                                                Selected: {selectedTenant.domain}\n                                                            </p>\n                                                            <p className=\"text-sm text-green-600\">\n                                                                {selectedTenant.displayName || 'No display name'}\n                                                            </p>\n                                                            <p className=\"text-xs text-green-500 font-mono\">\n                                                                {selectedTenant.tenantId}\n                                                            </p>\n                                                        </div>\n                                                        <Button\n                                                            variant=\"ghost\"\n                                                            size=\"sm\"\n                                                            onClick={() => {\n                                                                setSelectedTenant(null);\n                                                                setTenantId('');\n                                                                setTenantDomainName('');\n                                                            }}\n                                                        >\n                                                            <X className=\"h-4 w-4\" />\n                                                        </Button>\n                                                    </div>\n                                                </CardContent>\n                                            </Card>\n                                        )}\n                                    </CardContent>\n                                </Card>\n                            )}\n\n                            {/* Manual Entry for Interactive Mode */}\n                            {!isGdapMode && (\n                                <div className=\"space-y-4\">\n                                    <div>\n                                        <Label htmlFor=\"tenantId\">Tenant ID</Label>\n                                        <Input\n                                            id=\"tenantId\"\n                                            value={tenantId}\n                                            onChange={(e) => setTenantId(e.target.value)}\n                                            placeholder=\"Enter tenant ID (UUID format)\"\n                                            className=\"font-mono\"\n                                        />\n                                        <p className=\"text-xs text-gray-500 mt-1\">\n                                            The Azure AD tenant ID in UUID format\n                                        </p>\n                                    </div>\n                                    <div>\n                                        <Label htmlFor=\"domain\">Domain Name</Label>\n                                        <Input\n                                            id=\"domain\"\n                                            value={tenantDomainName}\n                                            onChange={(e) => setTenantDomainName(e.target.value)}\n                                            placeholder=\"Enter domain name (e.g., contoso.onmicrosoft.com)\"\n                                        />\n                                        <p className=\"text-xs text-gray-500 mt-1\">\n                                            The primary domain name of the tenant\n                                        </p>\n                                    </div>\n                                </div>\n                            )}\n\n                        </CardContent>\n                    </Card>\n                );\n\n            case 1:\n                return (\n                    <Card>\n                        <CardHeader>\n                            <CardTitle>Step 2: Validation</CardTitle>\n                            <CardDescription>Verify and confirm information</CardDescription>\n                        </CardHeader>\n                         {/*Validation step display*/}\n                        <CardContent className=\"space-y-4\">\n                            <div className=\"bg-gray-50 p-4 rounded-lg space-y-2\">\n                                <div className=\"flex justify-between\">\n                                    <span className=\"font-medium\">Customer:</span>\n                                    <span>{customerName}</span>\n                                </div>\n                                <div className=\"flex justify-between\">\n                                    <span className=\"font-medium\">Method:</span>\n                                    <Badge variant={isGdapMode ? \"default\" : \"secondary\"}>\n                                        {isGdapMode ? 'GDAP' : 'Interactive'}\n                                    </Badge>\n                                </div>\n                                <div className=\"flex justify-between\">\n                                    <span className=\"font-medium\">Tenant ID:</span>\n                                    <span className=\"font-mono text-sm\">\n            {isGdapMode ? selectedTenant?.tenantId : tenantId}\n        </span>\n                                </div>\n                                <div className=\"flex justify-between\">\n                                    <span className=\"font-medium\">Domain:</span>\n                                    <span>{isGdapMode ? selectedTenant?.domain : tenantDomainName}</span>\n                                </div>\n                                {isGdapMode && selectedTenant?.displayName && (\n                                    <div className=\"flex justify-between\">\n                                        <span className=\"font-medium\">Display Name:</span>\n                                        <span>{selectedTenant.displayName}</span>\n                                    </div>\n                                )}\n                                {isGdapMode && selectedTenant && (\n                                    <div className=\"flex justify-between\">\n                                        <span className=\"font-medium\">Status:</span>\n                                        <Badge variant=\"outline\" className=\"text-xs\">\n                                            {selectedTenant.isOnboarded ? 'Previously Onboarded' : 'New Tenant'}\n                                        </Badge>\n                                    </div>\n                                )}\n                            </div>\n                            <div className=\"bg-blue-50 p-4 rounded-lg\">\n                                <div className=\"flex items-start gap-2\">\n                                    <Info className=\"h-5 w-5 text-blue-600 mt-0.5\" />\n                                    <div className=\"text-sm text-blue-800\">\n                                        <p className=\"font-medium\">Next Step:</p>\n                                        {isGdapMode && selectedTenant?.isOnboarded && !selectedTenant?.isLinked ? (\n                                            <p>This tenant is already onboarded. We will link it to your customer account.</p>\n                                        ) : (\n                                            <>\n                                                <p>Admin consent will be initiated to grant necessary permissions for monitoring and management.</p>\n                                                {isGdapMode && (\n                                                    <p className=\"mt-1\">Using GDAP relationship for secure delegated access.</p>\n                                                )}\n                                            </>\n                                        )}\n                                    </div>\n                                </div>\n                            </div>\n                        </CardContent>\n                    </Card>\n                );\n\n            case 2:\n                return (\n                    <Card>\n                        <CardHeader>\n                            <CardTitle>Step 3: Admin Consent</CardTitle>\n                            <CardDescription>Grant necessary permissions</CardDescription>\n                        </CardHeader>\n                        <CardContent className=\"space-y-4\">\n                            {loading && (\n                                <div className=\"text-center py-6\">\n                                    <Loader2 className=\"h-8 w-8 animate-spin mx-auto mb-4\" />\n                                    <p className=\"font-medium\">Initiating consent process...</p>\n                                    <p className=\"text-sm text-gray-600 mt-2\">\n                                        A popup window will open for admin consent\n                                    </p>\n                                </div>\n                            )}\n\n                            {consentWindow && !consentCompleted && (\n                                <div className=\"text-center py-6\">\n                                    <ExternalLink className=\"h-8 w-8 mx-auto mb-4 text-blue-600\" />\n                                    <p className=\"font-medium\">Consent window is open</p>\n                                    <p className=\"text-sm text-gray-600 mt-2\">\n                                        Please complete the consent process in the popup window\n                                    </p>\n                                    <Button\n                                        variant=\"outline\"\n                                        size=\"sm\"\n                                        onClick={() => {\n                                            if (consentWindow) {\n                                                consentWindow.focus();\n                                            }\n                                        }}\n                                        className=\"mt-4\"\n                                    >\n                                        Focus Consent Window\n                                    </Button>\n                                </div>\n                            )}\n\n                            {!loading && !consentWindow && !consentCompleted && (\n                                <div className=\"text-center py-6\">\n                                    <Shield className=\"h-8 w-8 mx-auto mb-4 text-gray-400\" />\n                                    <p className=\"text-gray-600\">Consent process will start automatically</p>\n                                </div>\n                            )}\n                        </CardContent>\n                    </Card>\n                );\n\n            case 3:\n                return (\n                    <Card>\n                        <CardHeader>\n                            <CardTitle>Step 4: Complete</CardTitle>\n                            <CardDescription>Onboarding completed successfully</CardDescription>\n                        </CardHeader>\n                        <CardContent className=\"space-y-4\">\n                            <div className=\"text-center py-6\">\n                                <CheckCircle className=\"h-12 w-12 mx-auto mb-4 text-green-600\" />\n                                <p className=\"text-lg font-medium mb-2\">Onboarding Complete!</p>\n                                <p className=\"text-gray-600\">\n                                    {customerName} has been successfully onboarded and is ready for monitoring.\n                                </p>\n                            </div>\n                            <div className=\"bg-green-50 p-4 rounded-lg\">\n                                <div className=\"text-sm text-green-800\">\n                                    <p className=\"font-medium mb-1\">What happens next:</p>\n                                    <ul className=\"space-y-1 list-disc list-inside\">\n                                        <li>Tenant monitoring will begin shortly</li>\n                                        <li>Security alerts and reports will be available</li>\n                                        <li>Customer will appear in your dashboard</li>\n                                    </ul>\n                                </div>\n                            </div>\n                        </CardContent>\n                    </Card>\n                );\n\n            default:\n                return null;\n        }\n    };\n\n    return (\n        <Dialog open={isOpen} onOpenChange={onClose}>\n            <DialogContent className=\"!w-[90vw] !max-w-[90vw] h-[75vh] max-h-none overflow-y-auto\">\n            <DialogHeader>\n                    <DialogTitle className=\"flex items-center gap-2\">\n                        <Building className=\"h-5 w-5\" />\n                        Tenant Onboarding - {customerName}\n                    </DialogTitle>\n                </DialogHeader>\n\n                {/* Process Overview */}\n                <Card>\n                    <CardHeader>\n                        <CardTitle>Onboarding Process</CardTitle>\n                        <CardDescription>4-step process to onboard your customer</CardDescription>\n                    </CardHeader>\n                    <CardContent>\n                        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n                            <div className={`text-center p-4 ${currentStep >= 0 ? 'opacity-100' : 'opacity-50'}`}>\n                                <div className={`w-12 h-12 mx-auto mb-3 rounded-full flex items-center justify-center ${\n                                    currentStep >= 0 ? 'bg-blue-100 dark:bg-blue-900' : 'bg-gray-100'\n                                }`}>\n                                    <Building className={`h-6 w-6 ${currentStep >= 0 ? 'text-blue-600' : 'text-gray-400'}`} />\n                                </div>\n\n                                <h4 className=\"font-semibold mb-2\">1. Method Selection</h4>\n                                <p className=\"text-sm text-muted-foreground\">Choose onboarding method</p>\n                            </div>\n                            <div className={`text-center p-4 ${currentStep >= 1 ? 'opacity-100' : 'opacity-50'}`}>\n                                <div className={`w-12 h-12 mx-auto mb-3 rounded-full flex items-center justify-center ${\n                                    currentStep >= 1 ? 'bg-green-100 dark:bg-green-900' : 'bg-gray-100'\n                                }`}>\n                                    <CheckCircle className={`h-6 w-6 ${currentStep >= 1 ? 'text-green-600' : 'text-gray-400'}`} />\n                                </div>\n\n                                <h4 className=\"font-semibold mb-2\">2. Validation</h4>\n                                <p className=\"text-sm text-muted-foreground\">Verify information</p>\n                            </div>\n                            <div className={`text-center p-4 ${currentStep >= 2 ? 'opacity-100' : 'opacity-50'}`}>\n                                <div className={`w-12 h-12 mx-auto mb-3 rounded-full flex items-center justify-center ${\n                                    currentStep >= 2 ? 'bg-purple-100 dark:bg-purple-900' : 'bg-gray-100'\n                                }`}>\n                                    <Lock className={`h-6 w-6 ${currentStep >= 2 ? 'text-purple-600' : 'text-gray-400'}`} />\n                                </div>\n\n                                <h4 className=\"font-semibold mb-2\">3. Admin Consent</h4>\n                                <p className=\"text-sm text-muted-foreground\">Grant permissions</p>\n                            </div>\n                            <div className={`text-center p-4 ${currentStep >= 3 ? 'opacity-100' : 'opacity-50'}`}>\n                                <div className={`w-12 h-12 mx-auto mb-3 rounded-full flex items-center justify-center ${\n                                    currentStep >= 3 ? 'bg-yellow-100 dark:bg-yellow-900' : 'bg-gray-100'\n                                }`}>\n                                    <Users className={`h-6 w-6 ${currentStep >= 3 ? 'text-yellow-600' : 'text-gray-400'}`} />\n                                </div>\n\n                                <h4 className=\"font-semibold mb-2\">4. Complete</h4>\n                                <p className=\"text-sm text-muted-foreground\">Ready for monitoring</p>\n                            </div>\n                        </div>\n                    </CardContent>\n                </Card>\n\n                {/* Current Step Content */}\n                {renderStepContent()}\n\n                {/* Error Display */}\n                {error && (\n                    <div className=\"flex items-center gap-2 text-sm text-red-600 bg-red-50 p-3 rounded-md\">\n                        <AlertCircle className=\"h-4 w-4\" />\n                        {error}\n                    </div>\n                )}\n\n                {/* Navigation Buttons */}\n                <div className=\"flex gap-3 pt-4\">\n                    {currentStep > 0 && currentStep < 3 && (\n                        <Button variant=\"outline\" onClick={handleBack} disabled={loading}>\n                            Back\n                        </Button>\n                    )}\n\n                    {currentStep < 2 && (\n                        <Button onClick={handleNext} disabled={loading}>\n                            {currentStep === 1 && isGdapMode && selectedTenant?.isOnboarded && !selectedTenant?.isLinked\n                                ? 'Link Customer'\n                                : currentStep === 1\n                                    ? 'Start Consent'\n                                    : 'Next'\n                            }\n                        </Button>\n                    )}\n\n                    {currentStep === 3 && (\n                        <Button onClick={handleComplete} >\n                            Complete Onboarding\n                        </Button>\n                    )}\n\n                    <Button variant=\"outline\" onClick={onClose} disabled={loading}>\n                        {currentStep === 3 ? 'Close' : 'Cancel'}\n                    </Button>\n                </div>\n            </DialogContent>\n        </Dialog>\n    );\n};\n\nexport default TenantOnboardingModal;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2990, "column": 0}, "map": {"version":3,"sources":["file:///Users/srozemuller/Repos/IntuneAssistant/IntuneAssistant.WebInterface/app/customer/page.tsx"],"sourcesContent":["'use client';\nimport { useState, useEffect } from 'react';\nimport { useMsal } from '@azure/msal-react';\nimport { useTenant } from '@/contexts/TenantContext';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Switch } from '@/components/ui/switch';\nimport { useRouter } from 'next/navigation';\nimport { useCustomer } from '@/contexts/CustomerContext';\nimport { DataTable } from '@/components/DataTable';\n\nimport {\n    Building,\n    Mail,\n    Home,\n    Users,\n    Shield,\n    AlertCircle,\n    CheckCircle,\n    Loader2,\n    Plus,\n    Edit,\n    Trash2,\n    ExternalLink,\n    Lock, Grid2X2Check\n} from 'lucide-react';\nimport {CONSENT_CALLBACK, CUSTOMER_ENDPOINT, ITEMS_PER_PAGE} from '@/lib/constants';\nimport { apiScope } from \"@/lib/msalConfig\";\nimport TenantOnboardingModal from '@/components/onboarding/tenant-onboarding';\n\ninterface TenantUpdateData {\n    isActive: boolean;\n    isPrimary: boolean;\n    isTrial: boolean;\n    licenseType: number;\n}\n\ninterface CustomerTenantLicense {\n    id: string;\n    createdAt: string;\n    expiresAt: string | null;\n    isActive: boolean;\n    isTrial: boolean;\n    licenseType: number;\n    activatedBy: string;\n    isConsentGranted: boolean;\n    consentGrantedAt: string | null;\n    consentGrantedBy: string | null;\n    isOnboarded: boolean;\n    onboardedAt: string | null;\n    consentUrl: string | null;\n}\n\ninterface Tenant {\n    id: string;\n    tenantId: string;\n    displayName: string;\n    domainName: string;\n    isActive: boolean;\n    isPrimary: boolean;\n    isGdap: boolean;\n    isTrial: boolean;\n    lastLogin: string | null;\n    licenseType: number;\n    licenses?: CustomerTenantLicense[];\n}\n\ninterface License {\n    id: string; // Add this property\n    licenseType: number;\n    isActive: boolean;\n    isTrial: boolean;\n    maxTenants: number;\n    expiryDate: string | null;\n}\n\n\nexport default function CustomerPage() {\n    const { accounts, instance } = useMsal();\n    const { setSelectedTenant, selectedTenant } = useTenant();\n    const [currentPage, setCurrentPage] = useState(1);\n    const [itemsPerPage, setItemsPerPage] = useState(ITEMS_PER_PAGE);\n    const [scrollPosition, setScrollPosition] = useState(0);\n\n    const router = useRouter();\n    const { customerData, customerLoading: loading, customerError: error, refetchCustomerData } = useCustomer();\n\n    const [updatingTenants, setUpdatingTenants] = useState<Set<string>>(new Set());\n    const [showOnboardingModal, setShowOnboardingModal] = useState(false);\n    const [updateError, setUpdateError] = useState<string | null>(null);\n    const [showClickOverlay, setShowClickOverlay] = useState(false);\n    const [selectedTenantId, setSelectedTenantId] = useState<string | null>(null);\n    const { isActiveCustomer, customerLoading } = useCustomer();\n\n    const currentTenantId = accounts[0]?.tenantId;\n\n    // Add these state variables at the top of your component\n    const [consentWindow, setConsentWindow] = useState<Window | null>(null);\n    const [consentLoading, setConsentLoading] = useState<Set<string>>(new Set());\n    const [consentError, setConsentError] = useState<string | null>(null);\n\n    const [deleteLicenseConfirmation, setDeleteLicenseConfirmation] = useState<{\n        isOpen: boolean;\n        tenantId: string;\n        licenseId: string;\n        licenseName: string;\n    } | null>(null);\n\n    // Add useEffect for handling consent messages\n    useEffect(() => {\n        const handleConsentMessage = (event: MessageEvent) => {\n            console.log('Received consent message from origin:', event.origin);\n            console.log('Current window origin:', window.location.origin);\n\n            if (event.data?.type === 'CONSENT_SUCCESS' || event.data?.type === 'CONSENT_ERROR') {\n                console.log('Processing consent message:', event.data);\n\n                if (event.data.type === 'CONSENT_SUCCESS') {\n                    setConsentLoading(new Set());\n                    if (consentWindow) {\n                        setConsentWindow(null);\n                    }\n                    handleConsentCallback(event.data.state);\n                } else if (event.data.type === 'CONSENT_ERROR') {\n                    setConsentError(`Consent failed: ${event.data.errorDescription || event.data.error || 'Unknown error'}`);\n                    setConsentLoading(new Set());\n                    if (consentWindow) {\n                        setConsentWindow(null);\n                    }\n                }\n            }\n        };\n\n        window.addEventListener('message', handleConsentMessage);\n        return () => window.removeEventListener('message', handleConsentMessage);\n    }, [consentWindow]);\n\n    // Add consent callback handler\n    const handleConsentCallback = async (state?: string) => {\n        try {\n            const response = await instance.acquireTokenSilent({\n                scopes: [apiScope],\n                account: accounts[0]\n            });\n\n            const callbackResponse = await fetch(\n                `${CONSENT_CALLBACK}${state ? `?state=${state}` : ''}`,\n                {\n                    method: 'GET',\n                    headers: {\n                        'Authorization': `Bearer ${response.accessToken}`,\n                        'Content-Type': 'application/json',\n                    }\n                }\n            );\n\n            if (!callbackResponse.ok) {\n                const errorData = await callbackResponse.json().catch(() => null);\n                throw new Error(errorData?.message || `Failed to complete consent: ${callbackResponse.statusText}`);\n            }\n\n            // Refresh customer data to reflect consent status\n            await refetchCustomerData();\n            setConsentError(null);\n\n        } catch (err) {\n            console.error('Consent callback error:', err);\n            setConsentError(err instanceof Error ? err.message : 'Failed to complete consent');\n        }\n    };\n\n    // Add function to open consent popup\n    const openConsentPopup = (consentUrl: string, licenseId: string) => {\n        setConsentLoading(prev => new Set(prev).add(licenseId));\n        setConsentError(null);\n\n        const popup = window.open(\n            consentUrl,\n            'consent',\n            'width=600,height=700,scrollbars=yes,resizable=yes,location=yes,toolbar=yes'\n        );\n\n        if (popup) {\n            setConsentWindow(popup);\n            popup.focus();\n        } else {\n            setConsentError('Failed to open consent window. Please allow popups and try again.');\n            setConsentLoading(prev => {\n                const newSet = new Set(prev);\n                newSet.delete(licenseId);\n                return newSet;\n            });\n        }\n    };\n\n\n    useEffect(() => {\n        const handleScroll = () => {\n            const position = window.pageYOffset || document.documentElement.scrollTop;\n            setScrollPosition(position);\n            sessionStorage.setItem('customerPageScrollPosition', position.toString());\n        };\n\n        window.addEventListener('scroll', handleScroll);\n        return () => {\n            window.removeEventListener('scroll', handleScroll);\n            // Save final position when component unmounts\n            sessionStorage.setItem('customerPageScrollPosition', scrollPosition.toString());\n        };\n    }, [scrollPosition]);\n\n    useEffect(() => {\n        if (!loading && customerData) {\n            const savedPosition = sessionStorage.getItem('customerPageScrollPosition');\n            if (savedPosition) {\n                // Use setTimeout to ensure DOM is fully rendered\n                setTimeout(() => {\n                    window.scrollTo({\n                        top: parseInt(savedPosition),\n                        behavior: 'smooth'\n                    });\n                }, 100);\n            }\n        }\n    }, [loading, customerData]);\n    useEffect(() => {\n        return () => {\n            sessionStorage.removeItem('customerPageScrollPosition');\n        };\n    }, []);\n\n    const [licenseManagement, setLicenseManagement] = useState<{\n        isOpen: boolean;\n        tenant: Tenant | null;\n    } | null>(null);\n\n    const [updatingLicense, setUpdatingLicense] = useState<Set<string>>(new Set());\n    const [licenseError, setLicenseError] = useState<string | null>(null);\n\n    const updateTenantLicense = async (tenantId: string, licenseId: string, licenseData: {\n        isActive: boolean;\n        isPrimary: boolean;\n        isTrial: boolean;\n        licenseType: number;\n    }) => {\n        try {\n            setUpdatingLicense(prev => new Set(prev).add(`${tenantId}-${licenseId}`));\n            setLicenseError(null);\n\n            const response = await instance.acquireTokenSilent({\n                scopes: [apiScope],\n                account: accounts[0]\n            });\n\n            const apiResponse = await fetch(`${CUSTOMER_ENDPOINT}/tenants/${tenantId}/license/${licenseId}`, {\n                method: 'PATCH',\n                headers: {\n                    'Authorization': `Bearer ${response.accessToken}`,\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    IsActive: licenseData.isActive,\n                    IsPrimary: licenseData.isPrimary,\n                    IsTrial: licenseData.isTrial,\n                    LicenseType: licenseData.licenseType\n                }),\n            });\n\n            if (!apiResponse.ok) {\n                throw new Error(`Failed to update license: ${apiResponse.statusText}`);\n            }\n\n            // Parse the API response to get updated license data\n            const responseData = await apiResponse.json();\n            console.log('License update response:', responseData);\n\n            // Force a complete data refresh\n            await refetchCustomerData();\n\n            // Update the local license management state with fresh data\n            if (licenseManagement?.tenant) {\n                // Find the updated tenant in the fresh data\n                const updatedCustomerData = await refetchCustomerData();\n                // This will automatically update the UI with the fresh data\n            }\n\n        } catch (err) {\n            console.error('Failed to update tenant license:', err);\n            setLicenseError(err instanceof Error ? err.message : 'Failed to update license');\n        } finally {\n            setUpdatingLicense(prev => {\n                const newSet = new Set(prev);\n                newSet.delete(`${tenantId}-${licenseId}`);\n                return newSet;\n            });\n        }\n    };\n\n    useEffect(() => {\n        if (editTenant && customerData && editTenant.tenant) {\n            const updatedTenant = customerData.tenants.find(\n                (t: Tenant) => t.tenantId === editTenant.tenant!.tenantId\n            );\n\n            if (updatedTenant) {\n                setEditTenant({\n                    ...editTenant,\n                    tenant: updatedTenant\n                });\n            }\n        }\n    }, [customerData]);\n\n\n    const getLicenseTypeName = (licenseType: number): string => {\n        switch (licenseType) {\n            case 0:\n                return 'Assistant';\n            case 1:\n                return 'Assignments Manager';\n            default:\n                return 'Unknown';\n        }\n    };\n\n    const getLicenseTypeVariant = (licenseType: number): \"default\" | \"secondary\" | \"destructive\" | \"outline\" => {\n        switch (licenseType) {\n            case 0:\n                return 'outline';\n            case 1:\n                return 'secondary';\n            case 2:\n                return 'default';\n            default:\n                return 'destructive';\n        }\n    };\n\n    // Add this state for the add license dialog\n    const [addLicenseDialog, setAddLicenseDialog] = useState<{\n        isOpen: boolean;\n        tenantId: string;\n        tenantName: string;\n    } | null>(null);\n\n    const [newLicenseData, setNewLicenseData] = useState({\n        licenseType: 0,\n        isEnabled: true,\n        isTrial: false\n    });\n\n\n    const hasOnlyCommunityLicense = (): boolean => {\n        if (!customerData?.licenses || customerData.licenses.length === 0) {\n            return true; // No licenses means community only\n        }\n\n        return customerData.licenses.every(license => license.licenseType === 0);\n    };\n\n\n    const columns = [\n        {\n            key: \"displayName\",\n            label: \"Display Name\",\n            render: (value: unknown, row: Record<string, unknown>) => {\n                const tenant = row as unknown as Tenant;\n                return (\n                    <div className=\"flex items-center gap-2 text-sm font-medium truncate w-full text-left\">\n                    <span className=\"font-medium truncate transition-colors duration-200\">\n                        {tenant.displayName}\n                    </span>\n                    </div>\n                );\n            },\n        },\n        {\n            key: \"tenantId\",\n            label: \"Tenant ID\",\n            render: (value: unknown) => (\n                <code className=\"text-sm font-medium cursor-pointer truncate block w-full text-left\">\n                    {value as string}\n                </code>\n            ),\n        },\n        {\n            key: \"domainName\",\n            label: \"Domain\",\n            render: (value: unknown) => (\n                <code className=\"text-xs bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded font-medium\">\n                    {value as string}\n                </code>\n            ),\n        },\n        // Show consent status for community licenses\n        ...(hasOnlyCommunityLicense() ? [{\n            key: \"consentStatus\",\n            label: \"Consent Status\",\n            render: (value: unknown, row: Record<string, unknown>) => {\n                const tenant = row as unknown as Tenant;\n                const communityLicense = tenant.licenses?.find(license => license.licenseType === 0);\n\n                if (!communityLicense) {\n                    return <Badge variant=\"destructive\">No License</Badge>;\n                }\n\n                if (!communityLicense.isConsentGranted) {\n                    return (\n                        <div className=\"flex items-center gap-2\">\n                            <Badge variant=\"destructive\">\n                                <AlertCircle className=\"h-3 w-3 mr-1\" />\n                                Consent Required\n                            </Badge>\n                            {communityLicense.consentUrl && (\n                                <Button\n                                    size=\"sm\"\n                                    variant=\"outline\"\n                                    onClick={() => {\n                                        if (communityLicense.consentUrl) {\n                                            openConsentPopup(communityLicense.consentUrl, communityLicense.id);\n                                        }\n                                    }}\n                                    disabled={consentLoading.has(communityLicense.id)}\n                                    className=\"h-6 px-2 text-xs\"\n                                >\n                                    {consentLoading.has(communityLicense.id) ? (\n                                        <>\n                                            <Loader2 className=\"h-3 w-3 mr-1 animate-spin\" />\n                                            Processing...\n                                        </>\n                                    ) : (\n                                        'Grant Consent'\n                                    )}\n                                </Button>\n\n                            )}\n                        </div>\n                    );\n                }\n\n                if (!communityLicense.isOnboarded) {\n                    return (\n                        <Badge variant=\"outline\">\n                            <AlertCircle className=\"h-3 w-3 mr-1\" />\n                            Onboarding Required\n                        </Badge>\n                    );\n                }\n\n                return (\n                    <Badge variant=\"default\" className=\"bg-green-500 hover:bg-green-600 text-white\">\n                        <CheckCircle className=\"h-3 w-3 mr-1\" />\n                        Ready\n                    </Badge>\n                );\n            },\n        }] : []),\n        // Type and GDAP columns for non-community licenses\n        ...(!hasOnlyCommunityLicense() ? [{\n            key: \"isPrimary\",\n            label: \"Type\",\n            render: (value: unknown, row: Record<string, unknown>) => {\n                const tenant = row as unknown as Tenant;\n                return (\n                    <div className=\"flex gap-1\">\n                        {tenant.isPrimary && <Badge variant=\"default\" className=\"text-xs\">Primary</Badge>}\n                        {tenant.isTrial && <Badge variant=\"outline\" className=\"text-xs\">Trial</Badge>}\n                        {!tenant.isPrimary && !tenant.isTrial && <Badge variant=\"secondary\" className=\"text-xs\">Standard</Badge>}\n                    </div>\n                );\n            },\n        }] : []),\n        ...(!hasOnlyCommunityLicense() ? [{\n            key: \"isGdap\",\n            label: \"GDAP\",\n            render: (value: unknown) => {\n                const isGdap = value as boolean;\n                return (\n                    <Badge variant={isGdap ? \"default\" : \"outline\"}>\n                        {isGdap ? 'Enabled' : 'Disabled'}\n                    </Badge>\n                );\n            },\n        }] : []),\n        // License Status for non-community licenses\n        ...(isActiveCustomer && !hasOnlyCommunityLicense() ? [{\n            key: \"licenseType\",\n            label: \"License Status\",\n            render: (value: unknown, row: Record<string, unknown>) => {\n                const tenant = row as unknown as Tenant;\n                const licenseCount = tenant.licenses?.length || 0;\n                const hasLicenseNeedingConsent = tenant.licenses?.some(\n                    license => !license.isConsentGranted && license.consentUrl\n                );\n\n                return (\n                    <div className=\"flex items-center gap-2\">\n                        {hasLicenseNeedingConsent ? (\n                            <AlertCircle className=\"h-4 w-4 text-orange-500\" />\n                        ) : (\n                            <CheckCircle className=\"h-4 w-4 text-green-500\" />\n                        )}\n                        <span className=\"text-xs text-gray-500 dark:text-gray-400 font-mono bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded-full\">\n                        license count: {licenseCount}\n                    </span>\n                    </div>\n                );\n            },\n        }] : []),\n        ...(isActiveCustomer && !hasOnlyCommunityLicense() ? [{\n            key: \"actions\",\n            label: \"Actions\",\n            render: (value: unknown, row: Record<string, unknown>) => {\n                const tenant = row as unknown as Tenant;\n                const isUpdating = updatingTenants.has(tenant.tenantId);\n\n                return (\n                    <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={(e) => {\n                            e.stopPropagation();\n                            setEditTenant({\n                                isOpen: true,\n                                tenant: tenant\n                            });\n                        }}\n                        disabled={isUpdating}\n                        className=\"h-8 w-8 p-0 text-blue-600 hover:text-blue-800 hover:bg-blue-50 dark:hover:bg-blue-950\"\n                    >\n                        <Edit className=\"h-3 w-3\" />\n                    </Button>\n                );\n            },\n        }] : []),\n    ];\n\n\n// Add this helper function to calculate max tenants from all active licenses\n    const getMaxAllowedTenants = (): number => {\n        if (!customerData?.licenses || customerData.licenses.length === 0) {\n            return 0;\n        }\n\n        return customerData.licenses\n            .filter(license => license.isActive)\n            .reduce((total, license) => total + license.maxTenants, 0);\n    };\n\n// Add this helper to check if tenant limit is reached\n    const isTenantLimitReached = (): boolean => {\n        const maxTenants = getMaxAllowedTenants();\n        const currentTenantCount = customerData?.tenants?.length || 0;\n        return maxTenants > 0 && currentTenantCount >= maxTenants;\n    };\n\n    const [deletingTenants, setDeletingTenants] = useState<Set<string>>(new Set());\n    const [deleteError, setDeleteError] = useState<string | null>(null);\n    const deleteTenant = async (tenantId: string) => {\n        try {\n            // Save current scroll position before delete\n            const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\n            sessionStorage.setItem('customerPageScrollPosition', currentScroll.toString());\n\n            setDeletingTenants(prev => new Set(prev).add(tenantId));\n            setDeleteError(null);\n\n            const response = await instance.acquireTokenSilent({\n                scopes: [apiScope],\n                account: accounts[0]\n            });\n\n            const apiResponse = await fetch(`${CUSTOMER_ENDPOINT}/tenants/${tenantId}`, {\n                method: 'DELETE',\n                headers: {\n                    'Authorization': `Bearer ${response.accessToken}`,\n                },\n            });\n\n            if (!apiResponse.ok) {\n                throw new Error(`Failed to delete tenant: ${apiResponse.statusText}`);\n            }\n\n            // Refresh customer data after successful deletion\n            await refetchCustomerData();\n\n            // Restore scroll position after data refresh\n            setTimeout(() => {\n                const savedPosition = sessionStorage.getItem('customerPageScrollPosition');\n                if (savedPosition) {\n                    window.scrollTo({\n                        top: parseInt(savedPosition),\n                        behavior: 'smooth'\n                    });\n                }\n            }, 100);\n\n        } catch (err) {\n            console.error('Failed to delete tenant:', err);\n            setDeleteError(err instanceof Error ? err.message : 'Failed to delete tenant');\n        } finally {\n            setDeletingTenants(prev => {\n                const newSet = new Set(prev);\n                newSet.delete(tenantId);\n                return newSet;\n            });\n        }\n    };\n    const [deleteConfirmation, setDeleteConfirmation] = useState<{\n        isOpen: boolean;\n        tenantId: string;\n        tenantName: string;\n    } | null>(null);\n\n    const [editTenant, setEditTenant] = useState<{\n        isOpen: boolean;\n        tenant: Tenant | null;\n    } | null>(null);\n\n    const [editingTenant, setEditingTenant] = useState(false);\n    const [editError, setEditError] = useState<string | null>(null);\n\n    const updateTenantSettings = async (tenantId: string, settings: {\n        displayName: string;\n        isActive: boolean;\n        isPrimary: boolean;\n        isTrial: boolean;\n        licenseType: number;\n    }) => {\n        try {\n            setEditingTenant(true);\n            setEditError(null);\n\n            const response = await instance.acquireTokenSilent({\n                scopes: [apiScope],\n                account: accounts[0]\n            });\n\n            const apiResponse = await fetch(`${CUSTOMER_ENDPOINT}/tenants/${tenantId}/settings`, {\n                method: 'PATCH',\n                headers: {\n                    'Authorization': `Bearer ${response.accessToken}`,\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    displayName: settings.displayName,\n                    isActive: settings.isActive,\n                    isPrimary: settings.isPrimary,\n                    isTrial: settings.isTrial,\n                    licenseType: settings.licenseType\n                }),\n            });\n\n\n            if (!apiResponse.ok) {\n                throw new Error(`Failed to update tenant settings: ${apiResponse.statusText}`);\n            }\n\n            await refetchCustomerData();\n            setEditTenant(null);\n\n        } catch (err) {\n            console.error('Failed to update tenant settings:', err);\n            setEditError(err instanceof Error ? err.message : 'Failed to update tenant settings');\n        } finally {\n            setEditingTenant(false);\n        }\n    };\n\n    const deleteTenantLicense = async (tenantId: string, licenseId: string) => {\n        try {\n            setUpdatingLicense(prev => new Set(prev).add(`${tenantId}-${licenseId}`));\n            setLicenseError(null);\n\n            const response = await instance.acquireTokenSilent({\n                scopes: [apiScope],\n                account: accounts[0]\n            });\n\n            const apiResponse = await fetch(`${CUSTOMER_ENDPOINT}/tenants/${tenantId}/license/${licenseId}`, {\n                method: 'DELETE',\n                headers: {\n                    'Authorization': `Bearer ${response.accessToken}`,\n                },\n            });\n\n            if (!apiResponse.ok) {\n                throw new Error(`Failed to delete license: ${apiResponse.statusText}`);\n            }\n\n            await refetchCustomerData();\n\n        } catch (err) {\n            console.error('Failed to delete tenant license:', err);\n            setLicenseError(err instanceof Error ? err.message : 'Failed to delete license');\n        } finally {\n            setUpdatingLicense(prev => {\n                const newSet = new Set(prev);\n                newSet.delete(`${tenantId}-${licenseId}`);\n                return newSet;\n            });\n        }\n    };\n\n    // Add new state for license onboarding wizard\n    const [licenseOnboardingWizard, setLicenseOnboardingWizard] = useState<{\n        isOpen: boolean;\n        tenantId: string;\n        tenantName: string;\n        licenseType: number;\n        currentStep: number;\n        consentWindow: Window | null;\n        consentCompleted: boolean;\n        loading: boolean;\n        error: string | null;\n        consentState?: string | null;\n    } | null>(null);\n\n// Replace the existing add license dialog with this new wizard\n    const openLicenseOnboardingWizard = (tenantId: string, tenantName: string) => {\n        setLicenseOnboardingWizard({\n            isOpen: true,\n            tenantId,\n            tenantName,\n            licenseType: 0,\n            currentStep: 0, // 0: Select license, 1: Consent, 2: Complete\n            consentWindow: null,\n            consentCompleted: false,\n            loading: false,\n            error: null\n        });\n    };\n\n// Handle consent window messages for license wizard\n    useEffect(() => {\n        const handleLicenseConsentMessage = (event: MessageEvent) => {\n            if (event.origin !== window.location.origin || !licenseOnboardingWizard?.consentWindow) {\n                return;\n            }\n\n            if (event.data.type === 'CONSENT_SUCCESS') {\n                console.log('License consent success received');\n                setLicenseOnboardingWizard(prev => prev ? {\n                    ...prev,\n                    consentCompleted: true,\n                    loading: false\n                } : null);\n\n                if (licenseOnboardingWizard.consentWindow) {\n                    licenseOnboardingWizard.consentWindow.close();\n                    setLicenseOnboardingWizard(prev => prev ? {\n                        ...prev,\n                        consentWindow: null\n                    } : null);\n                }\n\n                // Complete the license creation process\n                completeLicenseCreation();\n\n            } else if (event.data.type === 'CONSENT_ERROR') {\n                console.log('License consent error received:', event.data);\n                setLicenseOnboardingWizard(prev => prev ? {\n                    ...prev,\n                    error: `Consent failed: ${event.data.errorDescription || event.data.error || 'Unknown error'}`,\n                    loading: false\n                } : null);\n\n                if (licenseOnboardingWizard.consentWindow) {\n                    licenseOnboardingWizard.consentWindow.close();\n                    setLicenseOnboardingWizard(prev => prev ? {\n                        ...prev,\n                        consentWindow: null\n                    } : null);\n                }\n            }\n        };\n\n        window.addEventListener('message', handleLicenseConsentMessage);\n        return () => window.removeEventListener('message', handleLicenseConsentMessage);\n    }, [licenseOnboardingWizard]);\n\n    const extractStateFromConsentUrl = (url: string): string | null => {\n        try {\n            const urlObj = new URL(url);\n            return urlObj.searchParams.get('state');\n        } catch (error) {\n            console.error('Failed to parse consent URL:', error);\n            return null;\n        }\n    };\n    const initiateLicenseConsent = async () => {\n        if (!licenseOnboardingWizard) return;\n\n        try {\n            setLicenseOnboardingWizard(prev => prev ? {\n                ...prev,\n                loading: true,\n                error: null\n            } : null);\n\n            const tokenResponse = await instance.acquireTokenSilent({\n                scopes: [apiScope],\n                account: accounts[0]\n            });\n\n            // First create the license\n            const createLicenseResponse = await fetch(`${CUSTOMER_ENDPOINT}/tenants/${licenseOnboardingWizard.tenantId}/license`, {\n                method: 'POST',\n                headers: {\n                    'Authorization': `Bearer ${tokenResponse.accessToken}`,\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    isEnabled: true,\n                    LicenseType: licenseOnboardingWizard.licenseType\n                }),\n            });\n\n            if (!createLicenseResponse.ok) {\n                const errorData = await createLicenseResponse.json().catch(() => null);\n                throw new Error(errorData?.message || `Failed to create license: ${createLicenseResponse.statusText}`);\n            }\n\n            const licenseResult = await createLicenseResponse.json();\n\n            // Get consent URL from the license creation response\n            const consentUrl = licenseResult.data?.consentUrl || licenseResult.consentUrl;\n\n            if (!consentUrl) {\n                throw new Error('No consent URL received from license creation');\n            }\n\n            const extractedState = extractStateFromConsentUrl(consentUrl);\n            setLicenseOnboardingWizard(prev => prev ? {\n                ...prev,\n                consentState: extractedState\n            } : null);\n\n\n            // Open consent window with the URL from license creation\n            const popup = window.open(\n                consentUrl,\n                'licenseConsentWindow',\n                'width=600,height=700,scrollbars=yes,resizable=yes,status=yes,location=yes,toolbar=no,menubar=no'\n            );\n\n            if (popup) {\n                setLicenseOnboardingWizard(prev => prev ? {\n                    ...prev,\n                    consentWindow: popup,\n                    currentStep: 1\n                } : null);\n                popup.focus();\n            } else {\n                throw new Error('Failed to open consent window. Please check your popup blocker settings.');\n            }\n\n        } catch (err) {\n            console.error('Error initiating license consent:', err);\n            setLicenseOnboardingWizard(prev => prev ? {\n                ...prev,\n                error: err instanceof Error ? err.message : 'Failed to initiate consent',\n                loading: false\n            } : null);\n        }\n    };\n\n\n// Complete license creation after consent\n    const completeLicenseCreation = async () => {\n        if (!licenseOnboardingWizard) return;\n\n        try {\n            setLicenseOnboardingWizard(prev => prev ? {\n                ...prev,\n                loading: true,\n                error: null\n            } : null);\n\n            const tokenResponse = await instance.acquireTokenSilent({\n                scopes: [apiScope],\n                account: accounts[0]\n            });\n\n            // Use the consent state in the callback URL\n\n            const response = await fetch(`${CONSENT_CALLBACK}?state=${licenseOnboardingWizard.consentState}`, {\n                method: 'GET',\n                headers: {\n                    'Authorization': `Bearer ${tokenResponse.accessToken}`,\n                    'Content-Type': 'application/json',\n                }\n            });\n\n            if (!response.ok) {\n                const errorData = await response.json().catch(() => null);\n                throw new Error(errorData?.message || `Failed to complete consent callback: ${response.statusText}`);\n            }\n\n            await refetchCustomerData();\n\n            setLicenseOnboardingWizard(prev => prev ? {\n                ...prev,\n                currentStep: 2,\n                loading: false\n            } : null);\n\n        } catch (err) {\n            console.error('Failed to complete license creation:', err);\n            setLicenseOnboardingWizard(prev => prev ? {\n                ...prev,\n                error: err instanceof Error ? err.message : 'Failed to complete license creation',\n                loading: false\n            } : null);\n        }\n    };\n\n\n// Wizard navigation\n    const handleLicenseWizardNext = () => {\n        if (!licenseOnboardingWizard) return;\n\n        if (licenseOnboardingWizard.currentStep === 0) {\n            // Start consent process\n            initiateLicenseConsent();\n        }\n    };\n\n\n    const assignNewLicense = async (tenantId: string, licenseType: number, licenseData: {\n        isActive: boolean;\n        isPrimary: boolean;\n        isTrial: boolean;\n        licenseType: number;\n    }) => {\n        try {\n            setUpdatingLicense(prev => new Set(prev).add(`${tenantId}-assign-${licenseType}`));\n            setLicenseError(null);\n\n            const response = await instance.acquireTokenSilent({\n                scopes: [apiScope],\n                account: accounts[0]\n            });\n\n            const apiResponse = await fetch(`${CUSTOMER_ENDPOINT}/tenants/${tenantId}/license`, {\n                method: 'POST',\n                headers: {\n                    'Authorization': `Bearer ${response.accessToken}`,\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    isActive: licenseData.isActive,\n                    IsPrimary: licenseData.isPrimary,\n                    IsTrial: licenseData.isTrial,\n                    LicenseType: licenseData.licenseType\n                }),\n            });\n\n            if (!apiResponse.ok) {\n                throw new Error(`Failed to assign license: ${apiResponse.statusText}`);\n            }\n\n            await refetchCustomerData();\n            setLicenseManagement(null);\n\n        } catch (err) {\n            console.error('Failed to assign license:', err);\n            setLicenseError(err instanceof Error ? err.message : 'Failed to assign license');\n        } finally {\n            setUpdatingLicense(prev => {\n                const newSet = new Set(prev);\n                newSet.delete(`${tenantId}-assign-${licenseType}`);\n                return newSet;\n            });\n        }\n    };\n\n\n    const getCustomerLicenseTypeName = (licenseType: number): string => {\n        switch (licenseType) {\n            case 0:\n                return 'Community';\n            case 1:\n                return 'Standard';\n            case 2:\n                return 'Enterprise';\n            default:\n                return 'Unknown';\n        }\n    };\n\n    const getCustomerLicenseVariant = (licenseType: number): \"default\" | \"secondary\" | \"destructive\" | \"outline\" => {\n        switch (licenseType) {\n            case 0:\n                return 'outline';\n            case 1:\n                return 'secondary';\n            case 2:\n                return 'default';\n            default:\n                return 'destructive';\n        }\n    };\n\n\n    const handleTenantSelect = (tenant: Tenant) => {\n        setShowClickOverlay(true);\n        setSelectedTenant(tenant);\n        setSelectedTenantId(tenant.id);\n        setTimeout(() => {\n            setShowClickOverlay(false);\n        }, 200);\n    };\n\n    const handleTenantOnboardingSuccess = async () => {\n        setShowOnboardingModal(false);\n        await refetchCustomerData();\n    };\n\n    if (loading) {\n        return (\n            <div className=\"p-6 max-w-6xl mx-auto\">\n                <div className=\"flex items-center justify-center h-64\">\n                    <Loader2 className=\"h-8 w-8 animate-spin\" />\n                    <span className=\"ml-2\">Loading customer information...</span>\n                </div>\n            </div>\n        );\n    }\n\n    if (error) {\n        return (\n            <div className=\"p-6 max-w-6xl mx-auto\">\n                <Card className=\"border-red-200\">\n                    <CardContent className=\"p-6\">\n                        <div className=\"flex items-center gap-2 text-red-600\">\n                            <AlertCircle className=\"h-5 w-5\" />\n                            <span>Error: {error}</span>\n                        </div>\n                        <Button onClick={refetchCustomerData} className=\"mt-4\">\n                            Retry\n                        </Button>\n                    </CardContent>\n                </Card>\n            </div>\n        );\n    }\n\n    if (!customerData) {\n        return (\n            <div className=\"p-6 max-w-6xl mx-auto\">\n                <Card>\n                    <CardContent className=\"p-6 text-center\">\n                        <p>No customer data available</p>\n                        <Button onClick={() => router.back()} className=\"mt-4\">\n                            Go Back\n                        </Button>\n                    </CardContent>\n                </Card>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"p-6 w-full max-w-none mx-auto px-8\">\n            <div className=\"mb-6\">\n                <Button\n                    variant=\"outline\"\n                    onClick={() => router.back()}\n                    className=\"mb-4\"\n                >\n                     Back\n                </Button>\n                <h1 className=\"text-3xl font-bold text-gray-900 dark:text-gray-100\">Customer Information</h1>\n                <p className=\"text-gray-600 dark:text-gray-300 mt-2\">Manage customer details and tenant access</p>\n            </div>\n\n            {consentError && (\n                <div className=\"flex items-center gap-2 text-sm text-red-600 bg-red-50 p-3 rounded-md mb-4\">\n                    <AlertCircle className=\"h-4 w-4\" />\n                    {consentError}\n                </div>\n            )}\n\n\n            {/* Show update error if any */}\n            {updateError && (\n                <Card className=\"border-red-200 mb-6\">\n                    <CardContent className=\"p-4\">\n                        <div className=\"flex items-center gap-2 text-red-600\">\n                            <AlertCircle className=\"h-4 w-4\" />\n                            <span className=\"text-sm\">{updateError}</span>\n                        </div>\n                    </CardContent>\n                </Card>\n            )}\n            {/* Show delete error if any */}\n            {deleteError && (\n                <Card className=\"border-red-200 mb-6\">\n                    <CardContent className=\"p-4\">\n                        <div className=\"flex items-center gap-2 text-red-600\">\n                            <AlertCircle className=\"h-4 w-4\" />\n                            <span className=\"text-sm\">{deleteError}</span>\n                        </div>\n                    </CardContent>\n                </Card>\n            )}\n\n            <div className=\"flex flex-col xl:flex-row gap-6 mb-6\">\n                {/* Customer Basic Information */}\n                <div className=\"xl:w-1/2\">\n                    <Card>\n                        <CardHeader>\n                            <CardTitle className=\"flex items-center gap-2\">\n                                <Building className=\"h-5 w-5\" />\n                                Customer Details\n                            </CardTitle>\n                        </CardHeader>\n                        <CardContent className=\"space-y-6\">\n                            {/* Basic Information */}\n                            <div className=\"space-y-3\">\n                                <div className=\"flex items-center gap-3\">\n                                    <Building className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                                    <div>\n                                        <p className=\"text-sm font-medium\">Customer Name</p>\n                                        <p className=\"text-sm text-gray-600 dark:text-gray-300\">{customerData.name}</p>\n                                    </div>\n                                </div>\n\n                                <div className=\"flex items-center gap-3\">\n                                    <Home className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                                    <div>\n                                        <p className=\"text-sm font-medium\">Address</p>\n                                        <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n                                            {customerData.address || 'Not provided'}\n                                        </p>\n                                    </div>\n                                </div>\n\n                                <div className=\"flex items-center gap-3\">\n                                    <Mail className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                                    <div>\n                                        <p className=\"text-sm font-medium\">Primary Contact</p>\n                                        <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n                                            {customerData.primaryContactEmail || 'Not provided'}\n                                        </p>\n                                    </div>\n                                </div>\n\n                                <div className=\"flex items-center gap-3\">\n                                    <Shield className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                                    <div>\n                                        <p className=\"text-sm font-medium\">Account Type</p>\n                                        <div className=\"flex gap-2 mt-1\">\n                                            <Badge variant={customerData.isMsp ? \"default\" : \"secondary\"}>\n                                                {customerData.isMsp ? 'MSP' : 'Direct'}\n                                            </Badge>\n                                            <Badge variant={customerData.isActive ? \"default\" : \"outline\"}>\n                                                {customerData.isActive ? 'Active' : 'Community'}\n                                            </Badge>\n                                            <Badge variant={customerData.isGdap ? \"default\" : \"secondary\"}>\n                                                {customerData.isGdap ? 'GDAP' : 'No GDAP'}\n                                            </Badge>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <div className=\"flex items-center gap-3\">\n                                    <Users className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                                    <div>\n                                        <p className=\"text-sm font-medium\">Home Tenant ID</p>\n                                        <code className=\"text-xs bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded\">\n                                            {customerData.homeTenantId}\n                                        </code>\n                                    </div>\n                                </div>\n                            </div>\n                        </CardContent>\n                    </Card>\n                </div>\n\n                {/* Right side - License Info and Summary */}\n                <div className=\"xl:w-1/2 flex flex-col gap-6\">\n                    {/* License Information */}\n                    {customerData.licenses && customerData.licenses.length > 0 && !hasOnlyCommunityLicense() && (\n                        <Card>\n                            <CardHeader>\n                                <CardTitle className=\"flex items-center gap-2\">\n                                    <Shield className=\"h-5 w-5\" />\n                                    License Information\n                                </CardTitle>\n                            </CardHeader>\n                            <CardContent>\n                                {/* Tenant Limit Warning */}\n                                {isTenantLimitReached() && (\n                                    <div className=\"mb-4 p-3 border border-amber-200 bg-amber-50 dark:bg-amber-950 dark:border-amber-800 rounded-lg\">\n                                        <div className=\"flex items-center gap-2 text-amber-700 dark:text-amber-300\">\n                                            <AlertCircle className=\"h-4 w-4\" />\n                                            <span className=\"text-sm font-medium\">\n                                                Maximum tenant limit reached ({customerData.tenants.length}/{getMaxAllowedTenants()} tenants)\n                                            </span>\n                                        </div>\n                                        <p className=\"text-xs text-amber-600 dark:text-amber-400 mt-1 ml-6\">\n                                            Contact support to increase your tenant limit or upgrade your license.\n                                        </p>\n                                    </div>\n                                )}\n\n                                <div className=\"space-y-2\">\n                                    {customerData.licenses.map((license, index) => (\n                                        <div key={index} className=\"bg-gray-50 dark:bg-gray-900 p-3 rounded-lg border\">\n                                            <div className=\"flex items-center justify-between mb-3\">\n                                                <Badge variant={getCustomerLicenseVariant(license.licenseType)} className=\"text-xs\">\n                                                    {getCustomerLicenseTypeName(license.licenseType)}\n                                                </Badge>\n                                                <div className=\"flex items-center gap-1\">\n                                                    <Badge variant={license.isActive ? \"default\" : \"secondary\"} className=\"text-xs\">\n                                                        {license.isActive ? 'Active' : 'Inactive'}\n                                                    </Badge>\n                                                    {license.isTrial && (\n                                                        <Badge variant=\"outline\" className=\"text-xs\">Trial</Badge>\n                                                    )}\n                                                </div>\n                                            </div>\n                                            <div className=\"flex items-center justify-between text-xs\">\n                                                <div className=\"flex items-center gap-1\">\n                                                    <span className=\"text-gray-500 dark:text-gray-400\">Max Tenants:</span>\n                                                    <span className=\"font-medium\">{license.maxTenants}</span>\n                                                </div>\n                                                <div className=\"flex items-center gap-1\">\n                                                    <span className=\"text-gray-500 dark:text-gray-400\">Expires:</span>\n                                                    <span className=\"font-medium\">\n                                                        {license.expiryDate\n                                                            ? new Date(license.expiryDate).toLocaleDateString()\n                                                            : 'Never'\n                                                        }\n                                                    </span>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    ))}\n                                </div>\n                            </CardContent>\n                        </Card>\n                    )}\n\n                    {/* Summary Stats */}\n                    <Card>\n                        <CardHeader>\n                            <CardTitle>Summary</CardTitle>\n                        </CardHeader>\n                        <CardContent>\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div className=\"text-center p-4 bg-blue-50 dark:bg-blue-950 rounded-lg border border-blue-200 dark:border-blue-800\">\n                                    <div className=\"text-2xl font-bold text-blue-700 dark:text-blue-300\">\n                                        {customerData.tenants.length}\n                                    </div>\n                                    <div className=\"text-sm font-medium text-blue-800 dark:text-blue-200\">Total Tenants</div>\n                                </div>\n                                <div className=\"text-center p-4 bg-green-50 dark:bg-green-950 rounded-lg border border-green-200 dark:border-green-800\">\n                                    <div className=\"text-2xl font-bold text-green-700 dark:text-green-300\">\n                                        {customerData.tenants.filter((t: Tenant) => t.isActive).length}\n                                    </div>\n                                    <div className=\"text-sm font-medium text-green-800 dark:text-green-200\">Enabled Tenants</div>\n                                </div>\n                            </div>\n                        </CardContent>\n                    </Card>\n                </div>\n            </div>\n\n            {/* Tenants Table */}\n            <Card>\n                <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"flex items-center gap-2\">\n                        <Users className=\"h-5 w-5\" />\n                        Tenant Management\n                    </CardTitle>\n                    {customerData.isMsp && customerData.isActive && (\n                        <div className=\"flex items-center gap-2\">\n                            <Button\n                                onClick={() => setShowOnboardingModal(true)}\n                                disabled={isTenantLimitReached()}\n                                className=\"flex items-center gap-2\"\n                            >\n                                <Plus className=\"h-4 w-4\" />\n                                Add Tenant\n                            </Button>\n                            {isTenantLimitReached() && (\n                                <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                ({customerData.tenants.length}/{getMaxAllowedTenants()} tenants)\n            </span>\n                            )}\n                        </div>\n                    )}\n\n                </CardHeader>\n                <CardContent className=\"relative\">\n                    {showClickOverlay && (\n                        <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-blue-200 to-transparent opacity-60 animate-shimmer\" />\n                    )}\n\n                    <DataTable\n                        data={customerData.tenants.map(tenant => tenant as unknown as Record<string, unknown>)}\n                        columns={columns}\n                        className=\"text-sm\"\n                        currentPage={currentPage}\n                        totalPages={Math.ceil(customerData.tenants.length / itemsPerPage)}\n                        itemsPerPage={itemsPerPage}\n                        onPageChange={setCurrentPage}\n                        onItemsPerPageChange={(newItemsPerPage) => {\n                            setItemsPerPage(newItemsPerPage);\n                            setCurrentPage(1);\n                        }}\n                        showPagination={true}\n                    />\n\n                </CardContent>\n            </Card>\n\n            {/* Delete Confirmation Dialog */}\n            {deleteConfirmation && (\n                <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[70]\">\n                    <Card className=\"w-full max-w-md mx-4\">\n                        <CardHeader>\n                            <CardTitle className=\"flex items-center gap-2 text-red-600\">\n                                <AlertCircle className=\"h-5 w-5\" />\n                                Confirm Delete\n                            </CardTitle>\n                        </CardHeader>\n                        <CardContent className=\"space-y-4\">\n                            <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n                                Are you sure you want to delete <span className=\"font-semibold\">&quot;{deleteConfirmation.tenantName}&quot;</span>?\n                            </p>\n                            <p className=\"text-xs text-red-600 dark:text-red-400\">\n                                This action cannot be undone and will permanently remove the tenant from the system.\n                            </p>\n                            <div className=\"flex justify-end gap-2 pt-2\">\n                                <Button\n                                    variant=\"outline\"\n                                    size=\"sm\"\n                                    onClick={() => setDeleteConfirmation(null)}\n                                >\n                                    Cancel\n                                </Button>\n                                <Button\n                                    variant=\"destructive\"\n                                    size=\"sm\"\n                                    onClick={() => {\n                                        if (deleteConfirmation) {\n                                            deleteTenant(deleteConfirmation.tenantId);\n                                            setDeleteConfirmation(null);\n                                            setEditTenant(null);\n                                        }\n                                    }}\n                                    className=\"bg-red-600 hover:bg-red-700\"\n                                >\n                                    Delete Tenant\n                                </Button>\n                            </div>\n                        </CardContent>\n                    </Card>\n                </div>\n            )}\n\n            {editTenant && (\n                <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n                    <Card className=\"w-full max-w-6xl mx-4 max-h-[90vh] overflow-y-auto\">\n                        <CardHeader>\n                            <CardTitle className=\"flex items-center gap-2\">\n                                <Edit className=\"h-5 w-5\" />\n                                Tenant Management - {editTenant.tenant?.displayName}\n                            </CardTitle>\n                            <p className=\"text-sm text-gray-500\">\n                                Manage tenant settings, licenses, and permissions in one place.\n                            </p>\n                        </CardHeader>\n                        <CardContent className=\"space-y-6\">\n                            {(editError || licenseError) && (\n                                <div className=\"p-3 border border-red-200 bg-red-50 dark:bg-red-950 dark:border-red-800 rounded-lg\">\n                                    <div className=\"flex items-center gap-2 text-red-600\">\n                                        <AlertCircle className=\"h-4 w-4\" />\n                                        <span className=\"text-sm\">{editError || licenseError}</span>\n                                    </div>\n                                </div>\n                            )}\n\n                            {/* Two Column Layout */}\n                            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                                {/* Left Column - Tenant Settings */}\n                                <div className=\"space-y-6\">\n                                    <div className=\"p-4 border rounded-lg\">\n                                        <h3 className=\"font-medium mb-4 flex items-center gap-2\">\n                                            <Building className=\"h-4 w-4\" />\n                                            Tenant Settings\n                                        </h3>\n\n                                        <form onSubmit={(e) => {\n                                            e.preventDefault();\n                                            const formData = new FormData(e.currentTarget);\n                                            const settings = {\n                                                displayName: formData.get('displayName') as string,\n                                                isActive: editTenant.tenant!.isActive,\n                                                isPrimary: editTenant.tenant!.isPrimary,\n                                                isTrial: editTenant.tenant!.isTrial,\n                                                licenseType: parseInt(formData.get('licenseType') as string)\n                                            };\n                                            updateTenantSettings(editTenant.tenant!.tenantId, settings);\n                                        }} className=\"space-y-4\">\n\n                                            <div className=\"space-y-2\">\n                                                <label className=\"text-sm font-medium\">Display Name</label>\n                                                <input\n                                                    name=\"displayName\"\n                                                    type=\"text\"\n                                                    defaultValue={editTenant.tenant?.displayName}\n                                                    className=\"w-full px-3 py-2 border rounded-md dark:bg-gray-800 dark:border-gray-600\"\n                                                    required\n                                                />\n                                            </div>\n\n                                            <div className=\"space-y-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n                                                <div className=\"text-sm font-medium mb-3\">Tenant Information</div>\n                                                <div className=\"space-y-3 text-sm\">\n                                                    <div className=\"flex justify-between\">\n                                                        <span className=\"text-gray-500\">Tenant ID:</span>\n                                                        <code className=\"text-gray-800 dark:text-gray-200\">{editTenant.tenant?.tenantId}</code>\n                                                    </div>\n                                                    <div className=\"flex justify-between\">\n                                                        <span className=\"text-gray-500\">Domain:</span>\n                                                        <code className=\"text-gray-800 dark:text-gray-200\">{editTenant.tenant?.domainName}</code>\n                                                    </div>\n                                                    <div className=\"flex justify-between\">\n                                                        <span className=\"text-gray-500\">Status:</span>\n                                                        <Badge variant={editTenant.tenant?.isActive ? \"default\" : \"secondary\"}>\n                                                            {editTenant.tenant?.isActive ? 'Active' : 'Inactive'}\n                                                        </Badge>\n                                                    </div>\n                                                    <div className=\"flex justify-between\">\n                                                        <span className=\"text-gray-500\">GDAP:</span>\n                                                        <Badge variant={editTenant.tenant?.isGdap ? \"default\" : \"outline\"}>\n                                                            {editTenant.tenant?.isGdap ? 'Enabled' : 'Disabled'}\n                                                        </Badge>\n                                                    </div>\n                                                </div>\n                                            </div>\n\n                                            <Button\n                                                type=\"submit\"\n                                                disabled={editingTenant}\n                                                className=\"w-full bg-blue-600 hover:bg-blue-700\"\n                                            >\n                                                {editingTenant ? (\n                                                    <>\n                                                        <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n                                                        Saving...\n                                                    </>\n                                                ) : (\n                                                    'Save Settings'\n                                                )}\n                                            </Button>\n                                        </form>\n                                    </div>\n\n                                    {/* Quick Actions */}\n                                    <div className=\"p-4 border rounded-lg\">\n                                        <h3 className=\"font-medium mb-4 flex items-center gap-2\">\n                                            <Shield className=\"h-4 w-4\" />\n                                            Quick Actions\n                                        </h3>\n                                        <div className=\"space-y-2\">\n                                            <Button\n                                                variant={selectedTenant?.tenantId === editTenant.tenant?.tenantId ? \"default\" : \"outline\"}\n                                                size=\"sm\"\n                                                onClick={() => {\n                                                    if (editTenant.tenant) {\n                                                        handleTenantSelect(editTenant.tenant);\n                                                    }\n                                                }}\n                                                className={`w-full justify-start ${\n                                                    selectedTenant?.tenantId === editTenant.tenant?.tenantId\n                                                        ? \"bg-green-600 hover:bg-green-700 text-white\"\n                                                        : \"\"\n                                                }`}\n                                            >\n                                                {selectedTenant?.tenantId === editTenant.tenant?.tenantId ? (\n                                                    <>\n                                                        <CheckCircle className=\"h-4 w-4 mr-2\" />\n                                                        Active Context\n                                                    </>\n                                                ) : (\n                                                    <>\n                                                        <Grid2X2Check className=\"h-4 w-4 mr-2\" />\n                                                        Set as Context\n                                                    </>\n                                                )}\n                                            </Button>\n                                            <Button\n                                                type=\"button\"\n                                                variant=\"outline\"\n                                                onClick={() => openLicenseOnboardingWizard(editTenant.tenant!.tenantId, editTenant.tenant!.displayName)}\n\n                                                className=\"w-full justify-start\"\n                                            >\n                                                <Plus className=\"h-4 w-4 mr-2\" />\n                                                Add New License\n                                            </Button>\n                                            <Button\n                                                type=\"button\"\n                                                variant=\"destructive\"\n                                                onClick={() => {\n                                                    setDeleteConfirmation({\n                                                        isOpen: true,\n                                                        tenantId: editTenant.tenant!.tenantId,\n                                                        tenantName: editTenant.tenant!.displayName\n                                                    });\n                                                }}\n                                                className=\"w-full justify-start\"\n                                            >\n                                                <Trash2 className=\"h-4 w-4 mr-2\" />\n                                                Delete Tenant\n                                            </Button>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                {/* Right Column - License Management */}\n                                <div className=\"space-y-6\">\n                                    <div className=\"p-4 border rounded-lg\">\n                                        <div className=\"flex items-center justify-between mb-4\">\n                                            <h3 className=\"font-medium flex items-center gap-2\">\n                                                <Shield className=\"h-4 w-4\" />\n                                                License Management\n                                            </h3>\n                                            <span className=\"text-xs text-gray-500 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded\">\n                                                {editTenant.tenant?.licenses?.length || 0} licenses\n                                            </span>\n                                        </div>\n\n                                        {editTenant.tenant?.licenses && editTenant.tenant.licenses.length > 0 ? (\n                                            <div className=\"space-y-3 max-h-96 overflow-y-auto\">\n                                                {editTenant.tenant.licenses.map((license) => {\n                                                    const licenseKey = `${editTenant.tenant?.tenantId}-${license.id}`;\n                                                    const isUpdating = updatingLicense.has(licenseKey);\n\n                                                    return (\n                                                        <div key={license.id} className=\"p-3 border rounded-lg bg-gray-50 dark:bg-gray-900\">\n                                                            <div className=\"flex items-center justify-between mb-3\">\n                                                                <Badge variant={getLicenseTypeVariant(license.licenseType)}>\n                                                                    {getLicenseTypeName(license.licenseType)}\n                                                                </Badge>\n                                                                <div className=\"flex items-center gap-2\">\n                                                                    {isUpdating && (\n                                                                        <Loader2 className=\"h-4 w-4 animate-spin text-blue-600\" />\n                                                                    )}\n                                                                  <Button\n                                                                        variant=\"outline\"\n                                                                        size=\"sm\"\n                                                                        onClick={() => {\n                                                                            setDeleteLicenseConfirmation({\n                                                                                isOpen: true,\n                                                                                tenantId: editTenant.tenant!.tenantId,\n                                                                                licenseId: license.id,\n                                                                                licenseName: getLicenseTypeName(license.licenseType)\n                                                                            });\n                                                                        }}\n                                                                        disabled={isUpdating}\n                                                                        className=\"h-6 w-6 p-0 text-red-600 hover:text-red-800\"\n                                                                    >\n                                                                        <Trash2 className=\"h-3 w-3\" />\n                                                                    </Button>\n                                                                </div>\n                                                            </div>\n\n                                                            {/* License Status */}\n                                                            <div className=\"flex items-center gap-2 mb-3\">\n                                                                {license.isConsentGranted ? (\n                                                                    <>\n                                                                        <CheckCircle className=\"h-4 w-4 text-green-500\" />\n                                                                        <span className=\"text-xs text-green-700 dark:text-green-400\">\n                                                                            Consented & {license.isOnboarded ? 'Onboarded' : 'Pending'}\n                                                                        </span>\n                                                                    </>\n                                                                ) : (\n                                                                    <>\n                                                                        <AlertCircle className=\"h-4 w-4 text-orange-500\" />\n                                                                        <span className=\"text-xs text-orange-700 dark:text-orange-400\">\n                                                                            Consent Required\n                                                                        </span>\n                                                                    </>\n                                                                )}\n                                                            </div>\n\n                                                            {/* Consent Button */}\n                                                            {!license.isConsentGranted && license.consentUrl && (\n                                                                <Button\n                                                                    variant=\"outline\"\n                                                                    size=\"sm\"\n                                                                    onClick={() => window.open(license.consentUrl!, '_blank')}\n                                                                    className=\"w-full mb-3 text-xs h-7 text-blue-600 hover:text-blue-800\"\n                                                                >\n                                                                    Grant Consent\n                                                                </Button>\n                                                            )}\n\n                                                            {/* Toggle Controls */}\n                                                            <div className=\"flex items-center justify-between text-xs\">\n                                                                <div className=\"flex items-center gap-2\">\n                                                                    <span>Active:</span>\n                                                                    <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                        <input\n                                                                            type=\"checkbox\"\n                                                                            checked={license.isActive}\n                                                                            onChange={(e) => {\n                                                                                updateTenantLicense(editTenant.tenant!.tenantId, license.id, {\n                                                                                    isActive: e.target.checked,\n                                                                                    isPrimary: false,\n                                                                                    isTrial: license.isTrial,\n                                                                                    licenseType: license.licenseType\n                                                                                });\n                                                                            }}\n                                                                            disabled={isUpdating}\n                                                                            className=\"sr-only peer\"\n                                                                        />\n                                                                        <div className=\"w-7 h-4 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-3 peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:left-[1px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-3 after:w-3 after:transition-all dark:border-gray-600 peer-checked:bg-green-600\"></div>\n                                                                    </label>\n                                                                </div>\n                                                                <div className=\"flex items-center gap-2\">\n                                                                    <span>Trial:</span>\n                                                                    <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                        <input\n                                                                            type=\"checkbox\"\n                                                                            checked={license.isTrial}\n                                                                            onChange={(e) => {\n                                                                                updateTenantLicense(editTenant.tenant!.tenantId, license.id, {\n                                                                                    isActive: license.isActive,\n                                                                                    isPrimary: false,\n                                                                                    isTrial: e.target.checked,\n                                                                                    licenseType: license.licenseType\n                                                                                });\n                                                                            }}\n                                                                            disabled={isUpdating}\n                                                                            className=\"sr-only peer\"\n                                                                        />\n                                                                        <div className=\"w-7 h-4 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-3 peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:left-[1px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-3 after:w-3 after:transition-all dark:border-gray-600 peer-checked:bg-purple-600\"></div>\n                                                                    </label>\n                                                                </div>\n                                                            </div>\n\n                                                            {/* Dates */}\n                                                            <div className=\"flex justify-between text-xs text-gray-500 mt-2 pt-2 border-t\">\n                                                                <span>Created: {new Date(license.createdAt).toLocaleDateString()}</span>\n                                                                <span>Expires: {license.expiresAt ? new Date(license.expiresAt).toLocaleDateString() : 'Never'}</span>\n                                                            </div>\n                                                        </div>\n                                                    );\n                                                })}\n                                            </div>\n                                        ) : (\n                                            <div className=\"text-center py-6 text-gray-500 border rounded-lg bg-gray-50 dark:bg-gray-900\">\n                                                <Shield className=\"h-6 w-6 mx-auto mb-2 opacity-50\" />\n                                                <p className=\"text-sm\">No licenses assigned</p>\n                                            </div>\n                                        )}\n                                    </div>\n                                </div>\n                            </div>\n\n                            {/* Bottom Actions */}\n                            <div className=\"flex justify-end gap-2 pt-4 border-t\">\n                                <Button\n                                    variant=\"outline\"\n                                    onClick={() => {\n                                        setEditTenant(null);\n                                        setEditError(null);\n                                        setLicenseError(null);\n                                    }}\n                                >\n                                    Close\n                                </Button>\n                            </div>\n                        </CardContent>\n                    </Card>\n                </div>\n            )}\n            {/* License Delete Confirmation Dialog */}\n            {deleteLicenseConfirmation && (\n                <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[70]\">\n                    <Card className=\"w-full max-w-md mx-4\">\n                        <CardHeader>\n                            <CardTitle className=\"flex items-center gap-2 text-red-600\">\n                                <AlertCircle className=\"h-5 w-5\" />\n                                Confirm License Deletion\n                            </CardTitle>\n                        </CardHeader>\n                        <CardContent className=\"space-y-4\">\n                            <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n                                Are you sure you want to delete the <span className=\"font-semibold\">&quot;{deleteLicenseConfirmation.licenseName}&quot;</span> license?\n                            </p>\n                            <p className=\"text-xs text-red-600 dark:text-red-400\">\n                                This action cannot be undone and will remove access to features provided by this license.\n                            </p>\n                            <div className=\"flex justify-end gap-2 pt-2\">\n                                <Button\n                                    variant=\"outline\"\n                                    size=\"sm\"\n                                    onClick={() => setDeleteLicenseConfirmation(null)}\n                                >\n                                    Cancel\n                                </Button>\n                                <Button\n                                    variant=\"destructive\"\n                                    size=\"sm\"\n                                    onClick={() => {\n                                        if (deleteLicenseConfirmation) {\n                                            deleteTenantLicense(deleteLicenseConfirmation.tenantId, deleteLicenseConfirmation.licenseId);\n                                            setDeleteLicenseConfirmation(null);\n                                        }\n                                    }}\n                                    className=\"bg-red-600 hover:bg-red-700\"\n                                >\n                                    Delete License\n                                </Button>\n                            </div>\n                        </CardContent>\n                    </Card>\n                </div>\n            )}\n\n            {/* License Onboarding Wizard */}\n            {licenseOnboardingWizard && (\n                <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]\">\n                    <Card className=\"w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto\">\n                        <CardHeader>\n                            <CardTitle className=\"flex items-center gap-2\">\n                                <Plus className=\"h-5 w-5\" />\n                                Add License - {licenseOnboardingWizard.tenantName}\n                            </CardTitle>\n                            <p className=\"text-sm text-gray-500\">\n                                Step {licenseOnboardingWizard.currentStep + 1} of 3\n                            </p>\n                        </CardHeader>\n                        <CardContent className=\"space-y-6\">\n                            {/* Progress Steps */}\n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div className={`text-center p-3 ${licenseOnboardingWizard.currentStep >= 0 ? 'opacity-100' : 'opacity-50'}`}>\n                                    <div className={`w-10 h-10 mx-auto mb-2 rounded-full flex items-center justify-center ${\n                                        licenseOnboardingWizard.currentStep >= 0 ? 'bg-blue-100 dark:bg-blue-900' : 'bg-gray-100'\n                                    }`}>\n                                        <Plus className={`h-5 w-5 ${licenseOnboardingWizard.currentStep >= 0 ? 'text-blue-600' : 'text-gray-400'}`} />\n                                    </div>\n                                    <h4 className=\"font-semibold text-sm\">Select License</h4>\n                                </div>\n                                <div className={`text-center p-3 ${licenseOnboardingWizard.currentStep >= 1 ? 'opacity-100' : 'opacity-50'}`}>\n                                    <div className={`w-10 h-10 mx-auto mb-2 rounded-full flex items-center justify-center ${\n                                        licenseOnboardingWizard.currentStep >= 1 ? 'bg-purple-100 dark:bg-purple-900' : 'bg-gray-100'\n                                    }`}>\n                                        <Lock className={`h-5 w-5 ${licenseOnboardingWizard.currentStep >= 1 ? 'text-purple-600' : 'text-gray-400'}`} />\n                                    </div>\n                                    <h4 className=\"font-semibold text-sm\">Grant Consent</h4>\n                                </div>\n                                <div className={`text-center p-3 ${licenseOnboardingWizard.currentStep >= 2 ? 'opacity-100' : 'opacity-50'}`}>\n                                    <div className={`w-10 h-10 mx-auto mb-2 rounded-full flex items-center justify-center ${\n                                        licenseOnboardingWizard.currentStep >= 2 ? 'bg-green-100 dark:bg-green-900' : 'bg-gray-100'\n                                    }`}>\n                                        <CheckCircle className={`h-5 w-5 ${licenseOnboardingWizard.currentStep >= 2 ? 'text-green-600' : 'text-gray-400'}`} />\n                                    </div>\n                                    <h4 className=\"font-semibold text-sm\">Complete</h4>\n                                </div>\n                            </div>\n\n                            {/* Step Content */}\n                            {licenseOnboardingWizard.currentStep === 0 && (\n                                <Card>\n                                    <CardHeader>\n                                        <CardTitle>Select License Type</CardTitle>\n                                        <CardDescription>Choose which license type to add to this tenant</CardDescription>\n                                    </CardHeader>\n                                    <CardContent className=\"space-y-4\">\n                                        <select\n                                            value={licenseOnboardingWizard.licenseType}\n                                            onChange={(e) => setLicenseOnboardingWizard(prev => prev ? {\n                                                ...prev,\n                                                licenseType: parseInt(e.target.value)\n                                            } : null)}\n                                            className=\"w-full p-3 border rounded-md dark:bg-gray-800 dark:border-gray-600\"\n                                        >\n                                            <option\n                                                value={0}\n                                                disabled={customerData?.tenants\n                                                    .find(t => t.tenantId === licenseOnboardingWizard.tenantId)\n                                                    ?.licenses?.some(license => license.licenseType === 0)\n                                                }\n                                            >\n                                                Assistant {customerData?.tenants\n                                                .find(t => t.tenantId === licenseOnboardingWizard.tenantId)\n                                                ?.licenses?.some(license => license.licenseType === 0)\n                                                ? '(Already assigned)' : ''\n                                            }\n                                            </option>\n                                            <option\n                                                value={1}\n                                                disabled={customerData?.tenants\n                                                    .find(t => t.tenantId === licenseOnboardingWizard.tenantId)\n                                                    ?.licenses?.some(license => license.licenseType === 1)\n                                                }\n                                            >\n                                                Assignments Manager {customerData?.tenants\n                                                .find(t => t.tenantId === licenseOnboardingWizard.tenantId)\n                                                ?.licenses?.some(license => license.licenseType === 1)\n                                                ? '(Already assigned)' : ''\n                                            }\n                                            </option>\n                                            <option\n                                                value={2}\n                                                disabled={customerData?.tenants\n                                                    .find(t => t.tenantId === licenseOnboardingWizard.tenantId)\n                                                    ?.licenses?.some(license => license.licenseType === 2)\n                                                }\n                                            >\n                                                Troubleshooter {customerData?.tenants\n                                                .find(t => t.tenantId === licenseOnboardingWizard.tenantId)\n                                                ?.licenses?.some(license => license.licenseType === 2)\n                                                ? '(Already assigned)' : ''\n                                            }\n                                            </option>\n                                        </select>\n                                        <p className=\"text-xs text-gray-500\">\n                                            License types already assigned to this tenant are disabled.\n                                        </p>\n                                    </CardContent>\n                                </Card>\n                            )}\n\n                            {licenseOnboardingWizard.currentStep === 1 && (\n                                <Card>\n                                    <CardHeader>\n                                        <CardTitle>Grant Admin Consent</CardTitle>\n                                        <CardDescription>Admin consent is required for the new license</CardDescription>\n                                    </CardHeader>\n                                    <CardContent className=\"space-y-4\">\n                                        {licenseOnboardingWizard.loading && (\n                                            <div className=\"text-center py-6\">\n                                                <Loader2 className=\"h-8 w-8 animate-spin mx-auto mb-4\" />\n                                                <p className=\"font-medium\">Processing consent...</p>\n                                            </div>\n                                        )}\n\n                                        {licenseOnboardingWizard.consentWindow && !licenseOnboardingWizard.consentCompleted && (\n                                            <div className=\"text-center py-6\">\n                                                <ExternalLink className=\"h-8 w-8 mx-auto mb-4 text-blue-600\" />\n                                                <p className=\"font-medium\">Consent window is open</p>\n                                                <p className=\"text-sm text-gray-600 mt-2\">\n                                                    Please complete the consent process in the popup window\n                                                </p>\n                                            </div>\n                                        )}\n                                    </CardContent>\n                                </Card>\n                            )}\n\n                            {licenseOnboardingWizard.currentStep === 2 && (\n                                <Card>\n                                    <CardHeader>\n                                        <CardTitle>License Added Successfully</CardTitle>\n                                        <CardDescription>The license has been added to the tenant</CardDescription>\n                                    </CardHeader>\n                                    <CardContent className=\"space-y-4\">\n                                        <div className=\"text-center py-6\">\n                                            <CheckCircle className=\"h-12 w-12 mx-auto mb-4 text-green-600\" />\n                                            <p className=\"text-lg font-medium mb-2\">License Added!</p>\n                                            <p className=\"text-gray-600\">\n                                                {getLicenseTypeName(licenseOnboardingWizard.licenseType)} license has been successfully added to {licenseOnboardingWizard.tenantName}.\n                                            </p>\n                                        </div>\n                                    </CardContent>\n                                </Card>\n                            )}\n\n                            {/* Error Display */}\n                            {licenseOnboardingWizard.error && (\n                                <div className=\"flex items-center gap-2 text-sm text-red-600 bg-red-50 p-3 rounded-md\">\n                                    <AlertCircle className=\"h-4 w-4\" />\n                                    {licenseOnboardingWizard.error}\n                                </div>\n                            )}\n\n                            {/* Navigation */}\n                            <div className=\"flex justify-end gap-2 pt-4 border-t\">\n                                {licenseOnboardingWizard.currentStep === 0 && (\n                                    <Button\n                                        onClick={handleLicenseWizardNext}\n                                        disabled={licenseOnboardingWizard.loading}\n                                    >\n                                        Start Consent Process\n                                    </Button>\n                                )}\n\n                                {licenseOnboardingWizard.currentStep === 2 && (\n                                    <Button onClick={() => setLicenseOnboardingWizard(null)}>\n                                        Complete\n                                    </Button>\n                                )}\n\n                                <Button\n                                    variant=\"outline\"\n                                    onClick={() => setLicenseOnboardingWizard(null)}\n                                    disabled={licenseOnboardingWizard.loading}\n                                >\n                                    {licenseOnboardingWizard.currentStep === 2 ? 'Close' : 'Cancel'}\n                                </Button>\n                            </div>\n                        </CardContent>\n                    </Card>\n                </div>\n            )}\n            {showOnboardingModal && (\n                <TenantOnboardingModal\n                    isOpen={showOnboardingModal}\n                    onClose={() => setShowOnboardingModal(false)}\n                    onSuccess={handleTenantOnboardingSuccess}\n                    customerId={customerData.id}\n                    customerName={customerData.name}\n                />\n            )}\n        </div>\n    );\n\n}"],"names":[],"mappings":"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","debugId":null}}]
}