{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/srozemuller/Repos/IntuneAssistant/IntuneAssistant.WebInterface/app/onboarding/page.tsx"],"sourcesContent":["// app/onboarding/page.tsx\n'use client';\nimport { useEffect, useState, Suspense } from 'react';\nimport { useSearchParams } from 'next/navigation';\nimport { Loader2, CheckCircle, AlertCircle } from 'lucide-react';\n\ninterface ConsentMessage {\n    type: 'CONSENT_SUCCESS' | 'CONSENT_ERROR';\n    adminConsent?: string | null;\n    state?: string | null;\n    tenantId?: string | null;\n    code?: string | null;\n    result?: unknown;\n    searchParams?: Record<string, string>;\n    error?: string | null;\n    errorDescription?: string | null;\n}\n\nfunction OnboardingCallbackContent() {\n    const searchParams = useSearchParams();\n    const [status, setStatus] = useState<'processing' | 'success' | 'error'>('processing');\n    const [message, setMessage] = useState<string>('');\n\n    useEffect(() => {\n        const processCallback = async () => {\n            const error = searchParams.get('error');\n            const errorDescription = searchParams.get('error_description');\n            const adminConsent = searchParams.get('admin_consent');\n            const state = searchParams.get('state');\n            const tenantId = searchParams.get('tenant');\n            const code = searchParams.get('code');\n\n            console.log('ðŸ”µ Onboarding callback received:', {\n                error,\n                errorDescription,\n                adminConsent,\n                state,\n                tenantId,\n                code\n            });\n\n            const sendMessageToParent = (messageData: ConsentMessage) => {\n                if (!window.opener || window.opener.closed) {\n                    console.log('No opener window available');\n                    return;\n                }\n\n                try {\n                    window.opener.postMessage(messageData, window.location.origin);\n                    console.log('Message sent with same origin');\n                } catch (error1) {\n                    try {\n                        const parentOrigin = window.opener.location.origin;\n                        window.opener.postMessage(messageData, parentOrigin);\n                        console.log('Message sent with parent origin');\n                    } catch (error2) {\n                        try {\n                            window.opener.postMessage(messageData, '*');\n                            console.log('Message sent with wildcard origin');\n                        } catch (error3) {\n                            console.error('Failed to send message to parent window:', error3);\n                        }\n                    }\n                }\n            };\n\n            if (error) {\n                setStatus('error');\n                setMessage(errorDescription || error || 'Admin consent was denied or failed.');\n\n                sendMessageToParent({\n                    type: 'CONSENT_ERROR',\n                    error: error,\n                    errorDescription: errorDescription\n                });\n                return;\n            }\n\n            // DO NOT call the server callback here â€” let customer-onboarding handle it.\n            if (adminConsent === 'True' || code) {\n                setStatus('success');\n                setMessage('Admin consent has been received. Processing will continue in the parent window.');\n\n                sendMessageToParent({\n                    type: 'CONSENT_SUCCESS',\n                    adminConsent: adminConsent,\n                    state: state,\n                    tenantId: tenantId,\n                    code: code,\n                    searchParams: Object.fromEntries(searchParams.entries())\n                });\n            } else {\n                setStatus('error');\n                setMessage('Unexpected response from consent flow');\n\n                sendMessageToParent({\n                    type: 'CONSENT_ERROR',\n                    error: 'unknown_response',\n                    errorDescription: 'Unexpected response from consent flow'\n                });\n            }\n        };\n\n        processCallback();\n    }, [searchParams]);\n\n    useEffect(() => {\n        if (status !== 'processing') {\n            const timer = setTimeout(() => {\n                console.log('Process completed, window should be closed by parent or user');\n            }, 3000);\n\n            return () => clearTimeout(timer);\n        }\n    }, [status]);\n\n    return (\n        <div className=\"flex items-center justify-center min-h-screen bg-gray-50\">\n            <div className=\"text-center max-w-md mx-auto p-6\">\n                {status === 'processing' && (\n                    <div className=\"space-y-4\">\n                        <Loader2 className=\"h-8 w-8 animate-spin mx-auto text-blue-600\" />\n                        <h2 className=\"text-xl font-semibold text-gray-900\">Processing onboarding...</h2>\n                        <p className=\"text-gray-600\">Please wait while we complete your setup.</p>\n                    </div>\n                )}\n\n                {status === 'success' && (\n                    <div className=\"space-y-4\">\n                        <CheckCircle className=\"h-12 w-12 mx-auto text-green-600\" />\n                        <h2 className=\"text-xl font-semibold text-gray-900\">Onboarding Complete!</h2>\n                        <p className=\"text-gray-600\">{message}</p>\n                        <p className=\"text-sm text-gray-500\">\n                            This window will close automatically, or you can close it manually.\n                        </p>\n                    </div>\n                )}\n\n                {status === 'error' && (\n                    <div className=\"space-y-4\">\n                        <AlertCircle className=\"h-12 w-12 mx-auto text-red-600\" />\n                        <h2 className=\"text-xl font-semibold text-gray-900\">Onboarding Failed</h2>\n                        <p className=\"text-gray-600\">{message}</p>\n                        <p className=\"text-sm text-gray-500\">\n                            You can close this window and try again.\n                        </p>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n\nexport default function OnboardingCallback() {\n    return (\n        <Suspense fallback={\n            <div className=\"flex items-center justify-center min-h-screen\">\n                <Loader2 className=\"h-8 w-8 animate-spin text-blue-600\" />\n            </div>\n        }>\n            <OnboardingCallbackContent />\n        </Suspense>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 269, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/lucide-react/dist/esm/icons/loader-circle.js","sources":["file:///Users/srozemuller/Repos/IntuneAssistant/IntuneAssistant.WebInterface/node_modules/lucide-react/src/icons/loader-circle.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [['path', { d: 'M21 12a9 9 0 1 1-6.219-8.56', key: '13zald' }]];\n\n/**\n * @component @name LoaderCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEgMTJhOSA5IDAgMSAxLTYuMjE5LTguNTYiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/loader-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst LoaderCircle = createLucideIcon('loader-circle', __iconNode);\n\nexport default LoaderCircle;\n"],"names":[],"mappings":";;;;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAuB;IAAC;QAAC,MAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,6BAAA,CAAA;YAA+B,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAC;CAAA;AAalG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,YAAA,CAAA,CAAA,KAAe,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,8JAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA","debugId":null}},
    {"offset": {"line": 307, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/lucide-react/dist/esm/icons/circle-check-big.js","sources":["file:///Users/srozemuller/Repos/IntuneAssistant/IntuneAssistant.WebInterface/node_modules/lucide-react/src/icons/circle-check-big.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M21.801 10A10 10 0 1 1 17 3.335', key: 'yps3ct' }],\n  ['path', { d: 'm9 11 3 3L22 4', key: '1pflzl' }],\n];\n\n/**\n * @component @name CircleCheckBig\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEuODAxIDEwQTEwIDEwIDAgMSAxIDE3IDMuMzM1IiAvPgogIDxwYXRoIGQ9Im05IDExIDMgM0wyMiA0IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/circle-check-big\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst CircleCheckBig = createLucideIcon('circle-check-big', __iconNode);\n\nexport default CircleCheckBig;\n"],"names":[],"mappings":";;;;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAA,CAAA,CAAA,CAAuB;IAClC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAmC,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IAChE;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAkB,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;CACjD;AAaA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,cAAA,CAAA,CAAA,KAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,8JAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAoB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA","debugId":null}}]
}